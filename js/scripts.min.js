const inittedInputs=[];function calcSize(t){const e=t/1024,s=e/1024;return s<1?`${parseInt(e)} кб`:s>=1?parseInt(100*s)/100+" мб":void 0}function findInittedInput(t,e=!1){const s=Array.from(document.querySelectorAll(t));if(e){return inittedInputs.filter(i)||null}return inittedInputs.find(i)||null;function i(t){return s.includes(t.rootElem)}}function findInittedInputByFlag(t,e=!1){if(e){return inittedInputs.filter(s)}return inittedInputs.find(s);function s(e){return e.instanceFlag===t}}function createElement(t,e,s){let i=document.createElement(t);return e&&(i.className=e),s&&i.insertAdjacentHTML("afterbegin",s),i}class _LocalStorage{setItem(t,e){const s=JSON.stringify(e);localStorage.setItem(t,s)}getItem(t){const e=localStorage.getItem(t);return JSON.parse(e)}}const _localStorage=new _LocalStorage;class Cookie{constructor(t){this.onOkClick=this.onOkClick.bind(this),this.onLearnMoreClick=this.onLearnMoreClick.bind(this),this.rootElem=t,this.cookieKey="vsevn_ad_cookie",this.okButton=this.rootElem.querySelector(".cookie__button--ok"),this.learnMoreButton=this.rootElem.querySelector(".cookie__link--learn-more");const e=_localStorage.getItem(this.cookieKey);e&&"object"==typeof e&&e.accept&&this.removeModal(),this.okButton.addEventListener("click",this.onOkClick),this.learnMoreButton.addEventListener("click",this.onLearnMoreClick)}onOkClick(){this.removeModal();let t=_localStorage.getItem(this.cookieKey);t&&"object"==typeof t||(t={}),t.accept=!0,_localStorage.setItem(this.cookieKey,t)}removeModal(){this.rootElem.remove()}onLearnMoreClick(){}}class ChooseTabs{constructor(t){this.tabChange=this.tabChange.bind(this),this.rootElem=t,this.tabs=this.rootElem.querySelectorAll("[data-tab-name]"),this.tabs.forEach((t=>t.addEventListener("click",this.tabChange)))}tabChange(t){const e=t.currentTarget;this.tabs.forEach((t=>{t!==e&&t.classList.remove("active"),e.classList.add("active")}));let s=findInittedInput(".resume__rubricks");s.show();let i="";switch(e.dataset.tabName){case"tab-1":i="соискатель";default:break;case"tab-2":i="работодатель"}s.setStatus(i)}}class Rubricks{constructor(t){this.onChange=this.onChange.bind(this),this.rootElem=t,this.limit=3,this.statusSpan=this.rootElem.querySelector(".rubricks__status"),this.checkboxesItems=Array.from(this.rootElem.querySelectorAll(".checkboxs__items_item")),this.rootElem.addEventListener("change",this.onChange)}show(){this.rootElem.classList.remove("none")}onChange(t){const e=t.target;Array.isArray(this.checked)||(this.checked=[]);const s=findInittedInput("#options");function i(t){t?s.show():s.hide()}(function(){if(e.checked)if(this.checked.length<this.limit)this.checked.push(e);else{e.checked=!1;this.checked.slice(this.limit).forEach((t=>t.checked=!1)),this.checked=this.checked.slice(0,this.limit)}else this.checked=this.checked.filter((t=>t!==e))}).call(this),this.checked.length>0?i(!0):i(!1),s.setRubricks()}setStatus(t){this.statusSpan.innerHTML="",this.statusSpan.insertAdjacentText("afterbegin",t)}}class Options{constructor(t){this.rootElem=t}show(){this.rootElem.classList.remove("none")}hide(){this.rootElem.classList.add("none")}setRubricks(){const t=this.rootElem.querySelector(".rubricks-categories").querySelector("span"),e=findInittedInput(".resume__rubricks").checked||[];let s="";e.forEach(((t,e,i)=>{s+=t.value,e!=i.length-1&&(s+=", ")})),t.innerHTML=s}}class PromotionData{constructor(t){this.onClick=this.onClick.bind(this),this.rootElem=t,this.text=this.rootElem.dataset.promotion,this.promotionOpenBlock=this.rootElem.querySelector(".prompt-hover-promotion__open"),this.rootElem.addEventListener("click",this.onClick),this.promotionOpenBlock&&this.promotionOpenBlock.insertAdjacentText("afterbegin",this.text)}onClick(t){t.preventDefault(),this.popup||this.createPopup(),this.popup.init()}createPopup(){const t=`<p class="popup__text">${this.text}</p>`;this.popup=new Popup({popupInner:t}),this.popup.rootElem.classList.add("popup--text")}}class Popup{constructor(t={}){this.onPopupClick=this.onPopupClick.bind(this);this.rootElem=createElement("div","popup",'\n            <div class="popup__body">\n                <div class="popup__cross"></div>\n            </div>'),this.popupBody=this.rootElem.querySelector(".popup__body"),t.popupInner&&this.popupBody.insertAdjacentHTML("beforeend",t.popupInner);const e=this.rootElem.dataset.transitionDuration;this.transitionDuration=e?parseInt(e.replace(/\D/g,"")):t.transitionDuration||400,this.rootElem.style.transitionDuration=this.transitionDuration/1e3+"s",this.popupBody.style.transitionDuration=this.transitionDuration/1e3+"s",this.setStyles("remove"),this.rootElem.addEventListener("click",this.onPopupClick),this.init()}onPopupClick(t){(t.target.classList.contains("popup")||t.target.classList.contains("popup__cross")||t.target.closest(".popup__cross"))&&this.remove()}setStyles(t){switch(t){case"show":this.rootElem.style.backgroundColor="rgba(0, 0, 0, 0.8)",this.popupBody.style.transform="perspective(600px) translate(0, 0) rotateX(0)";break;case"remove":this.rootElem.style.backgroundColor="rgba(0, 0, 0, 0)",this.popupBody.style.transform="perspective(600px) translate(0, -60vh) rotateX(45deg)"}}init(){document.querySelector(".wrapper").append(this.rootElem),document.body.classList.add("__locked-scroll"),setTimeout((()=>this.setStyles("show")),50)}remove(){this.setStyles("remove"),document.body.classList.remove("__locked-scroll"),setTimeout((()=>{this.rootElem.remove()}),this.transitionDuration)}}function getScrollWidth(){const t=createElement("div","","<div></div>");t.style.cssText="position: absolute; left: -100vw; z-index: -9; overflow: scroll; width: 100px; height: 100px;",t.querySelector("div").style.cssText="height: 250px; width: 100%",document.body.append(t);const e=t.offsetWidth-t.clientWidth;return t.remove(),e}const lockScrollObserver=new MutationObserver((()=>{const t=document.querySelector(".wrapper");document.body.classList.contains("__locked-scroll")?t.style.paddingRight=`${getScrollWidth()}px`:t.style.removeProperty("padding-right")}));lockScrollObserver.observe(document.body,{attributes:!0});let inittingSelectors=[{selector:".cookie",classInstance:Cookie},{selector:".resume__choose",classInstance:ChooseTabs},{selector:".resume__rubricks",classInstance:Rubricks},{selector:"#options",classInstance:Options},{selector:"[data-promotion]",classInstance:PromotionData}];function initInputs(){inittingSelectors.forEach((t=>{const e=t.selector,s=t.classInstance;Array.from(document.querySelectorAll(e)).filter((e=>!Boolean(inittedInputs.find((s=>s.rootElem===e&&s instanceof t.classInstance))))).forEach((e=>{const i=new s(e);t.flag&&(i.instanceFlag=t.flag),inittedInputs.push(i)}))}))}const inittingInputsBodyObserver=new MutationObserver((()=>{initInputs()}));inittingInputsBodyObserver.observe(document.body,{childList:!0,subtree:!0}),initInputs();class Input{constructor(t){this.onInput=this.onInput.bind(this),this.onFocus=this.onFocus.bind(this),this.onChange=this.onChange.bind(this),this.clear=this.clear.bind(this),this.onDocumentClick=this.onDocumentClick.bind(this),this.typeNumbersOnly=this.typeNumbersOnly.bind(this),this.rootElem=t,this.isRequired=this.rootElem.hasAttribute("data-required"),this.errorMessage=this.rootElem.querySelector(".work-error"),this.clearButton=this.rootElem.querySelector(".cross"),this.wrongValueMessageBlock=this.rootElem.querySelector(".text-input__wrong-value"),this.selectsTransitionDur=300,this.setMaxHeight=!0,this.rootElem.hasAttribute("data-unset-max-height")&&(this.rootElem.removeAttribute("data-unset-max-height"),this.setMaxHeight=!1),this.getSelectsWrap(),document.addEventListener("click",this.onDocumentClick),this.clearButton&&this.clearButton.addEventListener("click",this.clear)}initInput(){this.input.addEventListener("input",this.onInput),this.input.addEventListener("focus",this.onFocus),this.input.addEventListener("change",this.onChange),this.input.addEventListener("blur",this.onChange)}onInput(t){const e=this.input.value;this.selectsWrap&&this.highlitMatches(),e&&this.rootElem.classList.remove("__uncompleted"),e?this.inputWrapper.classList.add("__has-value"):this.inputWrapper.classList.remove("__has-value"),this.checkCompletion(t)}onFocus(){this.openSelects()}onChange(){const t=this.input.value;if(this.maskData){this.getClearedFromMaskValue(t)||(this.input.value="")}this.rootElem.classList.remove("__wrong-value"),this.checkCompletion()}clear(){this.input.value="",this.input.dispatchEvent(new Event("input")),this.input.dispatchEvent(new Event("change"))}onDocumentClick(t){t.target!==this.input&&this.closeSelects()}typeNumbersOnly(t){const e=t.target,s=e.value;e.value=s.replace(/\D/g,"")}getSelectsWrap(){if(this.selectsWrap=this.rootElem.querySelector(".selects-wrap")||this.rootElem.querySelector(".selects-wrap-checkbox"),!this.selectsWrap)return;let t=".selects-wrap__option";return this.selectsWrap.classList.contains("selects-wrap-checkbox")&&(t=".selects-checkbox"),this.selectValues=Array.from(this.selectsWrap.querySelectorAll(t)),this.selectValues.length?void 0:(this.selectValues=null,void(this.selectsWrap=null))}getSelectsHeight(){const t=this.selectsWrap.cloneNode(!0),e=this.selectsWrap.parentNode.offsetWidth;t.querySelectorAll(".none").forEach((t=>t.classList.remove("none"))),t.style.cssText=`width: ${e}px; overflow: visible; max-height: unset; visibility: visible; position: absolute;`,document.body.append(t);const s=t.offsetHeight;return t.remove(),s}closeSelects(){this.selectsWrap&&(this.rootElem.classList.remove("open-selects"),this.selectsWrap.style.maxHeight="0",this.selectsWrap.style.removeProperty("visibility"),this.selectsWrap.style.overflow="hidden",this.selectsWrap.style.cssText="padding: 0; margin: 0;")}openSelects(){if(!this.selectsWrap)return;this.rootElem.classList.add("open-selects");const t=this.getSelectsHeight();setTimeout((()=>{this.selectsWrap.style.cssText="visibility: visible; overflow: hidden;",this.setMaxHeight&&(this.selectsWrap.style.maxHeight=`${t}px`),setTimeout((()=>{this.selectsWrap.style.removeProperty("transition"),this.selectsWrap.style.removeProperty("overflow")}),this.selectsTransitionDur)}),0)}highlitMatches(t=null){const e=this.input.value.toLowerCase().trim();!!Boolean(this.selectValues.find((t=>t.text.includes(this.input.value))))||e.includes("выбрано")||e.includes("Выбрано")?this.selectsWrap.classList.remove("none"):this.selectsWrap.classList.add("none"),t||(t=this.selectValues.find((t=>t.text.toLowerCase().trim()===e))),t?this.selectValues.forEach((t=>{t.node.classList.remove("none"),this.setHighlightedText(t.text,t)})):this.selectValues.forEach((t=>{const s=t.text,i=s.toLowerCase().trim();if(i.includes(e)){t.node.classList.remove("none");const n=i.indexOf(e),o=n+e.length;let a=s.slice(0,n)+`<span class="highlight">${s.slice(n,o)}</span>`+s.slice(o);this.setHighlightedText(a,t)}else this.input.value.includes("выбрано")||this.input.value.includes("Выбрано")||t.node.classList.add("none")}))}}class TextInput extends Input{constructor(t){if(super(t),this.onMaskInput=this.onMaskInput.bind(this),this.wrapInMask=this.wrapInMask.bind(this),this.input=this.rootElem.querySelector(".text-input__input"),this.mask=this.input.dataset.inputMask,this.completionMask=this.input.dataset.completionMask,this.isNumbersOnly=this.input.hasAttribute("data-numbers-only"),this.inputWrapper=this.rootElem.querySelector(".text-input__wrapper"),this.inputWrapper||(this.inputWrapper=this.rootElem),this.closeSelects(),this.getSelectsWrap(),this.initInput(),this.isNumbersOnly&&this.input.addEventListener("input",this.typeNumbersOnly),this.mask&&(this.createMask(),this.input.addEventListener("input",this.onMaskInput)),this.wrongValueMessageBlock){this.wrongValueMessageBlock.querySelector(".wrong-value__cross").addEventListener("click",(()=>{this.rootElem.classList.remove("__wrong-value")}))}}checkCompletion(t){const e=this.input.value;if(this.mask){const t=new RegExp(this.mask);this.isCompleted=Boolean(e.match(t))}else if(this.completionMask){const t=new RegExp(this.completionMask);this.isCompleted=Boolean(e.match(t))}else this.isCompleted=Boolean(e);const s=!t||t&&"input"!==t.type;return!this.isCompleted&&e?this.rootElem.classList.add("__wrong-value"):(s&&this.input.value&&this.rootElem.classList.remove("__uncompleted"),this.rootElem.classList.remove("__wrong-value")),this.isCompleted}getSelectsWrap(){super.getSelectsWrap(),this.selectValues&&(this.selectValues=this.selectValues.map((t=>({node:t,text:t.textContent||val.innerText}))),this.selectValues.forEach((t=>{t.node.addEventListener("click",(()=>{this.input.value=t.text,this.input.dispatchEvent(new Event("input"))}))})))}createMask(){new RegExp(this.mask);let t=this.mask.split(/(\s)/);1===t.length&&(t=this.mask.split(/(\.+)/));const e=t.map((t=>new RegExp(t))),s=t.map((t=>t.replace("\\",""))),i=s.join("");this.maskData={regexps:e,substrings:s,unspacedMask:i}}onMaskInput(t){if(t.inputType&&t.inputType.includes("deleteContent"))return;const e=this.input.value;if("insertFromPaste"===t.inputType)return void setTimeout((()=>{let t=this.getClearedFromMaskValue(e);this.isNumbersOnly&&(t=t.replace(/[^0-9+()\s-]/g,"")),this.wrapInMask(t)}),100);let s=0;for(let t=0;t<this.maskData.regexps.length;t++){const i=this.maskData.regexps[t],n=this.maskData.substrings[t].length,o=e.slice(s,s+n);if(s+=n,o&&!o.match(i)){let t=this.getClearedFromMaskValue(e);this.wrapInMask(t);break}}}getClearedFromMaskValue(t){return this.maskData.regexps.forEach(((e,s)=>{this.maskData.substrings[s].includes(".")||(t=t.replace(e,""))})),t}wrapInMask(t){let e=this.maskData.unspacedMask;t.split("").forEach((t=>e=e.replace(".",t)));const s=e.includes(".")?e.indexOf("."):null;s&&(e=e.slice(0,s)),this.input.value=e.replace("\\","")}setHighlightedText(t,e){e.node.innerHTML=t}}class TextInputPhone extends TextInput{constructor(t){super(t),this.mask="\\+7 \\( ... \\) ... - .. - ..",this.createMask(),this.input.addEventListener("focus",this.onMaskInput),this.input.addEventListener("input",this.onMaskInput)}typeNumbersOnly(t){const e=t.target,s=e.value;e.value=s.replace(/[^0-9+()\s-]/g,"");const i=s.lastIndexOf("+");i>0&&(e.value=e.value.slice(0,i)+e.value.slice(i+1))}onMaskInput(t){"focus"!==t.type||this.input.value||(this.input.value="+7 ("),t.inputType&&t.inputType.includes("deleteContent")&&this.mask.startsWith("8")&&this.input.value.length<=5&&(this.input.value="");let e=this.input.value;let s=this.mask.match(/\s/)?6:4;const i=e.endsWith("8")&&e.length<=s||e.startsWith("8"),n=e.startsWith("+7")&&!this.mask.includes("+7")||!e;i&&this.mask.includes("+7")?(this.mask="8 800 ... - .. - ..",this.createMask(),this.input.setAttribute("maxlength","19"),this.input.value.includes("+7")&&(this.input.value=this.input.value.replace("+7","").replace("(","").replace(")",""))):(n||this.mask.startsWith("8")&&t.inputType&&t.inputType.includes("deleteContent"))&&(this.mask="\\+7 \\( ... \\) ... - .. - ..",this.createMask(),this.input.setAttribute("maxlength","24")),super.onMaskInput(t),(this.mask.includes("+7")&&"7"==e[5]||"7"==e[4])&&(this.input.value=this.input.value.slice(0,5)+this.input.value.slice(6))}}class TextInputRegions extends TextInput{constructor(t){super(t),this.setRegions()}setRegions(){fetch("/vsevn-ad/json/regions.json").then((t=>t.json())).then((t=>{let e="";this.selectsWrap||(this.selectsWrap=this.rootElem.querySelector(".selects-wrap")),t.forEach((t=>e+=function(t){return`<p class="selects-wrap__option small-text">${t}</p>`}(t))),this.selectsWrap.innerHTML="",this.selectsWrap.insertAdjacentHTML("afterbegin",e),this.getSelectsWrap()}))}}class TextInputCheckboxes extends Input{constructor(t){super(t),this.apply=this.apply.bind(this),this.removeTag=this.removeTag.bind(this),this.input=this.rootElem.querySelector(".selects-input-checkbox__input"),this.ariaLabel=this.input.getAttribute("aria-label")||"",this.applyButton=this.rootElem.querySelector(".selects-wrap-checkbox__button"),this.checkboxesBlock=this.rootElem.querySelector(".selects-wrap-checkbox"),this.checked=[],this.inputWrapper=this.rootElem.querySelector(".selects-input-checkbox__wrapper"),this.inputWrapper||(this.inputWrapper=this.rootElem);const e=this.rootElem.dataset.tagsSelect;this.tagsLists=document.querySelectorAll(`[data-tags-list="${e}"]`),this.getCheckboxes(),this.checkboxes.forEach((t=>t.value=t.value.replace(/\s\s/g,""))),this.closeSelects(),this.initInput(),this.applyButton&&this.applyButton.addEventListener("click",this.apply)}checkCompletion(){}getCheckboxes(){Array.isArray(this.checkboxes)||(this.checkboxes=[]);Array.from(this.checkboxesBlock.querySelectorAll(".selects-checkbox")).filter((t=>!this.checkboxes.includes(t))).forEach((t=>{t.value=t.value.replace(/\s\s/g,""),this.checkboxes.push(t),this.applyButton||t.addEventListener("change",this.apply)}))}apply(t=null){const e=!t||t&&t.isTrusted;this.checked=this.checkboxes.filter((t=>t.checked)),this.checked.length<1&&(this.input.value=""),1===this.checked.length&&(this.input.value=this.checked[0].value),this.checked.length>1&&(this.ariaLabel?this.input.value=this.ariaLabel+" (выбрано: "+this.checked.length+")":this.input.value="Выбрано: "+this.checked.length),e&&(this.input.dispatchEvent(new Event("change")),this.input.dispatchEvent(new Event("input"))),this.applyButton&&this.closeSelects(),this.tagsLists.length>0&&e&&this.addTags()}onDocumentClick(t){t.target===this.input||t.target===this.checkboxesBlock||t.target.closest(".selects-wrap-checkbox")||this.closeSelects()}getSelectsWrap(){super.getSelectsWrap(),this.selectValues&&(this.selectValues=this.selectValues.map((t=>({node:t.closest("label"),text:t.value.replace(/\s\s/g,""),textNode:t.closest("label").querySelector(".text")}))))}closeSelects(){super.closeSelects(),this.checkboxes.forEach((t=>{const e=this.checked.includes(t);t.checked=!!e}))}clear(){super.clear(),this.checkboxes.forEach((t=>{t.checked&&(t.checked=!1,this.apply())}))}highlitMatches(){const t=this.input.value.includes("выбрано");super.highlitMatches(t)}setHighlightedText(t,e){e.textNode.innerHTML=t}addTags(){function t(t){const e=t.target.closest(".tags-list__item");this.removeTag(e)}t=t.bind(this),Array.isArray(this.tags)||(this.tags=[]),this.checked.forEach((e=>{const s=this.tags.find((t=>t.value===e.value));if(s)return;const i={input:e,value:e.value,tags:[]};this.tagsLists.forEach((s=>{const n=createElement("li","tags-list__item",`\n                <div class="tags-list__item-text">${e.value}</div>\n                <svg class="tags-list__item-cross"><use xlink:href="#cross-icon"></use></svg>\n            `);s.append(n),i.tags.push(n),n.querySelector(".tags-list__item-cross").addEventListener("click",t.bind(this))})),this.tags.push(i)})),function(){this.tags.forEach((t=>{t.input.checked||t.tags.forEach((t=>this.removeTag(t)))}))}.call(this)}removeTag(t){const e=this.tags.find((e=>e.tags.indexOf(t)>=0));if(!e)return t.remove();e.input.checked=!1,e.input.dispatchEvent(new Event("change")),e.tags.forEach((t=>t.remove())),this.tags.splice(this.tags.indexOf(e),1)}}class TextInputCheckboxesRegion extends TextInputCheckboxes{constructor(t){super(t),this.setRegions()}setRegions(){fetch("/vsevn-ad/json/regions.json").then((t=>t.json())).then((t=>{let e="";this.selectsWrap||(this.selectsWrap=this.rootElem.querySelector(".selects-wrap-checkbox")),t.forEach((t=>e+=function(t){return`\n            <label class="flex checkboxs__items_item">\n                <input class="mr-5 checkbox selects-checkbox" type="checkbox" value="${t}">\n                <span class="checkmark">\n                <img src="img/checkmark.png" alt="checkmark">\n                <img class="checkmark-hover-img" src="img/check_mark_hover.png" alt="checkmark-hover">\n                </span>\n                <span class="text small-text">${t}</span>\n            </label>\n            `}(t))),this.selectsWrap.innerHTML="",this.selectsWrap.insertAdjacentHTML("afterbegin",e),this.getSelectsWrap(),this.getCheckboxes()}))}}class RadioWrapper{constructor(t){this.onChange=this.onChange.bind(this),this.rootElem=t,this.isRequired=this.rootElem.hasAttribute("data-required"),this.inputs=this.rootElem.querySelectorAll("input[type='radio']"),this.inputs.forEach((t=>t.addEventListener("change",this.onChange)))}checkCompletion(){const t=this.rootElem.querySelector("input:checked");return this.isCompleted=Boolean(t),this.isCompleted}onChange(){this.rootElem.querySelector("input:checked")&&this.rootElem.classList.remove("__uncompleted")}}class PageInputButtons{constructor(t){this.onChange=this.onChange.bind(this),this.rootElem=t,this.isRequired=this.rootElem.hasAttribute("data-required"),this.inputWrappers=Array.from(this.rootElem.querySelectorAll(".radios-item__radios")),this.requiredInputWrappers=this.inputWrappers.filter((t=>!t.hasAttribute("data-optional"))),this.inputWrappers.forEach((t=>t.addEventListener("change",this.onChange)))}checkCompletion(){this.checkInputsCompletion();const t=this.getUncheckedRequired();return this.isCompleted=t.length<1,this.isCompleted}checkInputsCompletion(){const t=this.getUncheckedRequired(),e=this.inputWrappers.filter((e=>!t.includes(e)));t.forEach((t=>t.classList.add("__uncompleted"))),e.forEach((t=>t.classList.remove("__uncompleted"))),t.length<1&&this.rootElem.classList.remove("__uncompleted")}getUncheckedRequired(){return this.requiredInputWrappers.filter((t=>!t.querySelector("input:checked")))}onChange(){this.rootElem.classList.contains("__uncompleted")&&this.checkInputsCompletion()}}class AddFieldButton{constructor(t){this.onClick=this.onClick.bind(this),this.rootElem=t,this.addData=this.rootElem.dataset.addField.split(", "),this.selector=this.addData[0];const e=parseInt(this.addData[1]);this.maxFieldsAmount=e>0?e:1,this.cloneRef=document.querySelector(this.selector),this.cloneRef.closest(".selects-item")&&(this.cloneRef=this.cloneRef.closest(".selects-item")),this.counter=2,this.addedFields=[],this.rootElem.addEventListener("click",this.onClick)}onClick(){this.addField()}addField(){if(this.addedFields.length>this.maxFieldsAmount)return;const t=this.cloneRef.cloneNode(!0);this.replaceUniqueAttributes(t);const e=this.createRemoveButton();t.append(e),this.rootElem.before(t),this.addedFields.push(t),e.addEventListener("click",(()=>this.removeField(t))),this.addedFields.length>=this.maxFieldsAmount&&this.rootElem.classList.add("none")}replaceUniqueAttributes(t,e=!1){function s(t,s){const i=t.getAttribute(s);if(!i)return;let n;if(e){let t=i.match(/\d+\b/);if(!t)return;const e=i.indexOf(t);if(t=parseInt(t[0]),t<=0||t==1/0)return;let s=t-1;n=i.slice(0,e)+s.toString()}else n=i.trim().replace(/\d\b/,"").replace(/\-\b/,"")+"-"+this.counter.toString();t.setAttribute(s,n)}s=s.bind(this),t.querySelectorAll("[name]").forEach((t=>s(t,"name"))),t.querySelectorAll("[id]").forEach((t=>s(t,"id"))),t.querySelectorAll("label[for]").forEach((t=>s(t,"for"))),this.counter++}createRemoveButton(){const t=createElement("button","add__button remove first-minus remove-field",'\n            <span class="add__plus-wrap mr-10"> \n                <span class="add__plus">_</span>\n            </span>\n            <span class="add__text">Удалить</span>\n        ');return t.setAttribute("type","button"),t}removeField(t){const e=this.addedFields.indexOf(t);this.addedFields.filter(((t,s)=>s>e)).forEach((t=>this.replaceUniqueAttributes(t,!0))),this.addedFields.splice(e,1),t.remove(),this.counter--,this.addedFields.length<this.maxFieldsAmount&&this.rootElem.classList.remove("none")}}class AddFieldByInput{constructor(t){this.onChange=this.onChange.bind(this),this.rootElem=t;const e=this.rootElem.dataset.addfieldInput,s=this.rootElem.getAttribute("name"),i=Array.from(document.querySelectorAll(`[data-addfield-input-target="${e}"]`));this.creatingElems=i.map((t=>({elem:t,anchor:createElement("div","none")}))),this.otherInputs=document.querySelectorAll(`input[name="${s}"]`),this.onChange(),this.otherInputs.forEach((t=>t.addEventListener("change",this.onChange)))}onChange(){this.rootElem.checked?this.add():this.remove()}remove(){this.creatingElems.forEach((t=>{t.elem.replaceWith(t.anchor)}))}add(){this.creatingElems.forEach((t=>{t.anchor.replaceWith(t.elem)}))}}class CreatePopup{constructor(t){this.createPopup=this.createPopup.bind(this),this.rootElem=t;const e=this.rootElem.dataset.createPopup;if(!e)throw new Error("Не указаны параметры data-create-popup для");this.popupData=e.split(", "),this.popupName=this.popupData[0],this.rootElem.removeAttribute("data-create-popup");switch(this.rootElem.getAttribute("type")){case"checkbox":case"radio":this.initInputButton();break;default:this.initClickableButton()}}initInputButton(){const t=this.rootElem.getAttribute("name");document.querySelectorAll(`input[name="${t}"]`).forEach((t=>{t.addEventListener("change",(()=>{this.rootElem.checked&&this.initPopup()}))}))}initClickableButton(){this.rootElem.addEventListener("click",this.initPopup)}createPopup(){switch(this.popupName){case"standard":default:this.popup=new Popup;break;case"select-tags":const t='\n                <h3 class="popup__title">\n                    Регион/населенный пункт:\n                </h3>\n                <div class="selects-input-checkbox selects-input-checkbox--region" data-unset-max-height data-tags-select="other-regions-responses">\n                    <div class="selects-input-checkbox__wrapper">\n                        <input class="selects-input-checkbox__input" type="text">\n                        <span class="arrow"></span>\n                        <span class="cross">\n                            <svg>\n                                <use xlink:href="#cross-icon"></use>\n                            </svg>\n                        </span>\n                        <div class="prompt-hover__open">Очистить поле?</div>\n                        <div class="selects-wrap-checkbox" style="padding: 0px; margin: 0px;"></div>\n                    </div>\n                </div>\n                ';this.popup=new Popup({popupInner:t})}}initPopup(){this.popup||this.createPopup(),this.popup.init()}}class AddPhoto{constructor(t){this.onChange=this.onChange.bind(this),this.rootElem=t,this.input=this.rootElem.querySelector(".add-photo__input"),this.addPhotoWrapper=this.rootElem.querySelector(".add-photo__wrapper"),this.infoBlock=this.rootElem.querySelector(".add-photo__info"),this.button=this.rootElem.querySelector(".add-photo__button"),this.images=[],this.input.addEventListener("change",this.onChange)}onChange(){const t=this.input.files;for(let e=0;e<t.length;e++){const s=t[e];if(!s.type.startsWith("image/"))return;const i=calcSize(s.size);if(i.includes("мб")&&i>5)return;const n=new Image;n.onload=()=>{const t=createElement("div","add-photo__loaded-image"),s=createElement("div","add-photo__loaded-image-cross",'<svg><use xlink:href="#cross-icon"></use></svg>');s.addEventListener("click",(()=>this.removeImage(e))),t.append(n),t.append(s),this.images.push({img:n,fileIndex:e,imgWrapper:t}),this.appendImages()};const o=new FileReader;o.onload=t=>{n.src=t.target.result},o.readAsDataURL(s)}}appendImages(){this.toggleButton(),this.images.forEach((t=>{t.imgWrapper.closest("body")||this.addPhotoWrapper.append(t.imgWrapper)}))}toggleButton(){this.images.length>0?(this.infoBlock.classList.add("none"),this.button.classList.add("none")):(this.infoBlock.classList.remove("none"),this.button.classList.remove("none"))}removeImage(t){(function(){const e=this.images.find((e=>e.fileIndex==t));this.images=this.images.filter((t=>t!==e)),e.imgWrapper.remove()}).call(this),function(){const e=new DataTransfer,s=this.input.files;for(let i=0;i<s.length;i++){const n=s[i];i!==t&&e.items.add(n)}this.input.files=e.files}.call(this),this.toggleButton()}}class Form{constructor(t){this.onSubmit=this.onSubmit.bind(this),this.rootElem=t,this.rootElem.addEventListener("submit",this.onSubmit)}onSubmit(t){t.preventDefault();const e=findInittedInputByFlag("inputParams",!0).filter((t=>{if(!t.isRequired)return!1;return!t.checkCompletion()}));e.length>0&&e.forEach((t=>t.rootElem.classList.add("__uncompleted")))}}let inputsInittingSelectors=[{selector:".text-input--standard",classInstance:TextInput,flag:"inputParams"},{selector:".text-input--regions",classInstance:TextInputRegions,flag:"inputParams"},{selector:".text-input--phone",classInstance:TextInputPhone,flag:"inputParams"},{selector:"[data-add-field]",classInstance:AddFieldButton,flag:"inputParams"},{selector:"[data-addfield-input]",classInstance:AddFieldByInput,flag:"inputParams"},{selector:"[data-create-popup]",classInstance:CreatePopup,flag:"inputParams"},{selector:".selects-input-checkbox--standard",classInstance:TextInputCheckboxes,flag:"inputParams"},{selector:".selects-input-checkbox--region",classInstance:TextInputCheckboxesRegion,flag:"inputParams"},{selector:".radio-wrap",classInstance:RadioWrapper,flag:"inputParams"},{selector:".page-input-buttons",classInstance:PageInputButtons,flag:"inputParams"},{selector:".add-photo",classInstance:AddPhoto,flag:"inputParams"},{selector:"#form",classInstance:Form}];inittingSelectors=inittingSelectors.concat(inputsInittingSelectors);