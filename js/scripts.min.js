const inittedInputs=[];function assignPropertiesToObj(t,e={},s=":"){return t.forEach((t=>{const i=t.split(s),n=i[0],o=i[1];e[n]=o})),e}function getCoords(t){const e=t.getBoundingClientRect();return{top:e.top+window.pageYOffset,left:e.left+window.pageXOffset}}function calcSize(t){const e=t/1024,s=e/1024;return s<1?`${parseInt(e)} кб`:s>=1?parseInt(100*s)/100+" мб":void 0}function findInittedInput(t,e=!1){const s=Array.from(document.querySelectorAll(t));if(e){return inittedInputs.filter(i)||null}return inittedInputs.find(i)||null;function i(t){return s.includes(t.rootElem)}}function findInittedInputByFlag(t,e=!1){if(e){return inittedInputs.filter(s)}return inittedInputs.find(s);function s(e){return e.instanceFlag===t}}function createElement(t,e,s){let i=document.createElement(t);return e&&(i.className=e),s&&i.insertAdjacentHTML("afterbegin",s),i}function findClosest(t,e){let s=t.querySelector(e),i=t;for(;!s&&i!==document.body;)i=i.parentNode,s=i.querySelector(e);return s}class _LocalStorage{setItem(t,e){const s=JSON.stringify(e);localStorage.setItem(t,s)}getItem(t){const e=localStorage.getItem(t);return JSON.parse(e)}}const _localStorage=new _LocalStorage;class Cookie{constructor(t){this.onOkClick=this.onOkClick.bind(this),this.onLearnMoreClick=this.onLearnMoreClick.bind(this),this.rootElem=t,this.cookieKey="vsevn_ad_cookie",this.okButton=this.rootElem.querySelector(".cookie__button--ok"),this.learnMoreButton=this.rootElem.querySelector(".cookie__link--learn-more");const e=_localStorage.getItem(this.cookieKey);e&&"object"==typeof e&&e.accept&&this.removeModal(),this.okButton.addEventListener("click",this.onOkClick),this.learnMoreButton.addEventListener("click",this.onLearnMoreClick)}onOkClick(){this.removeModal();let t=_localStorage.getItem(this.cookieKey);t&&"object"==typeof t||(t={}),t.accept=!0,_localStorage.setItem(this.cookieKey,t)}removeModal(){this.rootElem.remove()}onLearnMoreClick(){}}class ChooseTabs{constructor(t){this.tabChange=this.tabChange.bind(this),this.rootElem=t,this.tabs=this.rootElem.querySelectorAll("[data-tab-name]"),this.tabs.forEach((t=>t.addEventListener("click",this.tabChange)))}tabChange(t){const e=t.currentTarget;this.tabs.forEach((t=>{t!==e&&t.classList.remove("active"),e.classList.add("active")}));let s=findInittedInput(".resume__rubricks");s.show();let i="";switch(e.dataset.tabName){case"applicant":i="соискатель";default:break;case"employer":i="работодатель"}s.setStatus(i),this.status=i,this.rootElem.dispatchEvent(new CustomEvent("change-tab",{detail:{status:i,name:e.dataset.tabName||applicant}}))}}class Rubricks{constructor(t){this.onChange=this.onChange.bind(this),this.rootElem=t,this.limit=3,this.statusSpan=this.rootElem.querySelector(".rubricks__status"),this.checkboxesItems=Array.from(document.querySelectorAll('[name="rubrick-checkbox"]')),this.checkboxesItems.forEach((t=>t.addEventListener("change",this.onChange)))}show(){this.rootElem.classList.remove("none")}onChange(t){const e=t.target;Array.isArray(this.checked)||(this.checked=[]);const s=findInittedInput("#options");function i(t){t?s.show():s.hide()}(function(){if(e.checked)if(this.checked.length<this.limit)this.checked.push(e);else{e.checked=!1;this.checked.slice(this.limit).forEach((t=>t.checked=!1)),this.checked=this.checked.slice(0,this.limit)}else this.checked=this.checked.filter((t=>t!==e))}).call(this),this.checked.length>0?i(!0):i(!1),s.setRubricks(),this.checkboxesItems=Array.from(document.querySelectorAll('[name="rubrick-checkbox"]'))}setStatus(t){this.statusSpan.innerHTML="",this.statusSpan.insertAdjacentText("afterbegin",t)}}class StatusDependable{constructor(t){this.setState=this.setState.bind(this),this.rootElem=t,findInittedInput(".resume__choose").rootElem.addEventListener("change-tab",this.setState)}setState(t){return t.detail}}class StatusDependableText extends StatusDependable{constructor(t){super(t),this.getStatuses(),this.getProperties()}getProperties(){let t=this.rootElem.dataset.statusDependableAttrs;this.rootElem.removeAttribute("data-status-dependable-attrs"),this.changeableProperties=t?t.split(", "):["innerHTML"]}getStatuses(){const t=this.rootElem.dataset.statusDependableText.split(" || ");this.data=assignPropertiesToObj(t,{},"::"),this.rootElem.removeAttribute("data-status-dependable-text")}setState(t){const e=super.setState(t).name;this.changeableProperties.forEach((t=>{this.rootElem[t]=this.data[e]||""}))}}class StatusDependableDisplay extends StatusDependable{constructor(t){super(t),this.rootElem=t,this.conditionTabs=this.rootElem.dataset.statusDependableDisplay.split(", "),this.anchor=createElement("div","none"),this.rootElem.removeAttribute("data-status-dependable-display")}setState(t){const e=super.setState(t).name;if(this.conditionTabs.includes(e)){if(this.rootElem.closest("body"))return;this.anchor.replaceWith(this.rootElem)}else this.rootElem.replaceWith(this.anchor)}}class Options{constructor(t){this.rootElem=t}show(){this.rootElem.classList.remove("none")}hide(){this.rootElem.classList.add("none")}setRubricks(){const t=this.rootElem.querySelectorAll(".rubricks-categories"),e=findInittedInput(".resume__rubricks").checked||[],s=findInittedInput(".resume__rubricks");t.forEach((t=>{const s=t.querySelector("span");let i="";e.forEach(((t,e,s)=>{i+=t.value,e!=s.length-1&&(i+=", ")})),s.innerHTML=i}));document.querySelectorAll(".rubricks-checkboxes").forEach((t=>{let i="";e.forEach((t=>{i+=`\n                <label class="flex checkboxs__items_item">\n                    <input name="rubrick-checkbox" class="mr-5 checkbox" type="checkbox" value="${t.value}" checked>\n                    <span class="checkmark">\n                    <img src="img/checkmark.png" alt="checkmark">\n                    <img class="checkmark-hover-img" src="img/check_mark_hover.png" alt="checkmark-hover">\n                    </span>\n                    <span class="text big-text">${t.value}</span>\n                </label>\n                `})),t.innerHTML=i,t.querySelectorAll('[name="rubrick-checkbox"').forEach((t=>{t.addEventListener("change",(()=>{const e=s.checkboxesItems.find((e=>e.value===t.value));e&&(e.checked=t.checked,e.dispatchEvent(new Event("change")))}))}))}))}}class PromotionAbout{constructor(t){this.onClick=this.onClick.bind(this),this.rootElem=t,this.text=this.rootElem.dataset.promotionAbout,this.promotionOpenBlock=this.rootElem.querySelector(".promotion-item__tip-modal"),this.rootElem.addEventListener("click",this.onClick),this.promotionOpenBlock&&this.promotionOpenBlock.insertAdjacentText("afterbegin",this.text),this.rootElem.removeAttribute("data-promotion-about")}onClick(t){t.preventDefault(),this.popup||this.createPopup(),this.popup.init()}createPopup(){const t=`<p class="popup__text">${this.text}</p>`;this.popup=new Popup({popupInner:t}),this.popup.rootElem.classList.add("popup--text")}}class Popup{constructor(t={}){this.onPopupClick=this.onPopupClick.bind(this),this.data=t;this.rootElem=createElement("div","popup",'\n            <div class="popup__body">\n                <div class="popup__cross"></div>\n            </div>'),this.popupBody=this.rootElem.querySelector(".popup__body"),t.popupInner&&this.popupBody.insertAdjacentHTML("beforeend",t.popupInner);const e=this.rootElem.dataset.transitionDuration;this.transitionDuration=e?parseInt(e.replace(/\D/g,"")):t.transitionDuration||400,this.rootElem.style.transitionDuration=this.transitionDuration/1e3+"s",this.popupBody.style.transitionDuration=this.transitionDuration/1e3+"s",this.setStyles("remove"),this.rootElem.addEventListener("click",this.onPopupClick)}onPopupClick(t){(t.target.classList.contains("popup")||t.target.classList.contains("popup__cross")||t.target.closest(".popup__cross"))&&this.remove()}setStyles(t){switch(t){case"show":this.rootElem.style.backgroundColor="rgba(0, 0, 0, 0.8)",this.popupBody.style.transform="perspective(600px) translate(0, 0) rotateX(0)";break;case"remove":this.rootElem.style.backgroundColor="rgba(0, 0, 0, 0)",this.popupBody.style.transform="perspective(600px) translate(0, -60vh) rotateX(45deg)"}}init(t=!1){return new Promise((e=>{t&&this.rootElem.classList.add("none"),document.querySelector(".wrapper").append(this.rootElem),document.body.classList.add("__locked-scroll"),setTimeout((()=>{this.inputsParams=inittedInputs.filter((t=>t.rootElem.closest(".popup")===this.rootElem)),e(this.inputsParams)}),0),setTimeout((()=>this.setStyles("show")),50)}))}remove(){this.setStyles("remove"),document.body.classList.remove("__locked-scroll"),setTimeout((()=>{this.rootElem.remove(),this.rootElem.classList.remove("none")}),this.transitionDuration)}}class PromotionBlock{constructor(t){this.onOptionChange=this.onOptionChange.bind(this),this.rootElem=t,this.rootElem.addEventListener("click",this.onClick),this.options=Array.from(this.rootElem.querySelectorAll("[data-promotion-option]")).map((t=>{let e=t.dataset.promotionOption;if(e.includes("changeable")||t.removeAttribute("data-promotion-option"),!e)return null;e=e.split(", ");const s=parseInt(e[0].split("|")[0]),i=parseInt(e[0].split("|")[1])||0,n=!!i&&100-s/(i/100),o=t.querySelector("input[type='radio']")||t.querySelector("input[type='checkbox']"),a=o.closest(".promotion-item").querySelector(".promotion-item__amount-input"),r="changeable"===e[1]&&{input:a};return t.addEventListener("click",(()=>{const t=o.getAttribute("type");if("radio"===t&&o.checked)return;"checkbox"===t&&o.checked?o.checked=!1:o.checked=!0;document.querySelectorAll(`[name="${o.getAttribute("name")}"]`).forEach((t=>t.dispatchEvent(new Event("change"))))})),{option:t,input:o,price:s,oldPrice:i,discount:n,changeable:r}})).filter((t=>t)),this.options.forEach((t=>{const e=t.input;e&&e.addEventListener("change",this.onOptionChange)})),this.totalPriceBlock=this.rootElem.querySelector(".total"),this.handleBonus(),this.handleCodeWords(),this.onOptionChange(),this.toggleCodeWordsBlock(),this.createPromotionMore()}handleBonus(){function t(){this.bonusInput.value="-"+this.bonusInput.value.replace(/\D/g,"");const t=parseInt(this.bonusInput.value.replace(/-/g,""));t>0?t>this.bonusNumber&&(this.bonusInput.value="-"+this.bonusNumber):NaN==t&&(this.input.value="")}function e(){(parseInt(this.bonusInput.value.replace(/-/g,""))||0)>this.totalPrice&&(this.bonusInput.value="-"+this.totalPrice),this.calcTotalPrice()}t=t.bind(this),e=e.bind(this),this.bonusNumberSpan=this.totalPriceBlock.querySelector(".bouns-number"),this.bonusNumberSpan?this.bonusNumber=parseInt(this.bonusNumberSpan.textContent.replace(/\D/g,"")||this.bonusNumber.innerText.replace(/\D/g,"")):this.bonusNumber=1e3,this.bonusInput=this.rootElem.querySelector("#total-input"),this.bonusInput.addEventListener("input",t),this.bonusInput.addEventListener("change",e)}onOptionChange(){this.checkedOptions=this.options.filter((t=>t.input.checked)),this.calcTotalPrice(),this.toggleCodeWordsBlock()}calcTotalPrice(){n=n.bind(this),this.totalPrice=0,this.checkedOptions.forEach((t=>{if(t.changeable){const e=t.input.closest(".promotion-item__input-button > input").querySelector(".promotion-item__amount-input"),s=parseInt(e.value.replace(/\D/g,""));this.totalPrice+=t.price*s}else this.totalPrice+=t.price}));const t=this.totalPriceBlock.querySelector(".total__data");t.innerHTML="",this.totalPrice>0?(this.totalPriceBlock.classList.remove("none"),this.checkedOptions.forEach((e=>{t.insertAdjacentHTML("beforeend",n(e))})),t.insertAdjacentHTML("beforeend",n())):this.totalPriceBlock.classList.add("none");let e=parseInt(this.bonusInput.value.replace(/-/g,""));e||(e=0);let s=this.totalPrice-e;s<0&&(s=0);const i=this.rootElem.querySelector(".total__item_calculated");function n(t=null){let e=this.totalPrice;t&&(e=t.changeable?t.price*t.changeable.input.value:t.price);return`\n            <div class="total__item">\n                <div class="total__item-title">\n                    <div>${t?`\n                    ${t.input.value}\n                    <span class="mr-5 ml-5">\n                        ${t.oldPrice||t.price}\n                    </span> \n                    р. \n                    ${t.discount?`скидка ${t.discount}%`:""}\n                `:"ИТОГО:"}</div>\n                </div>\n                <div class="total__item-content">\n                    <span class="total__item_total-item">\n                        ${t?e:this.totalPrice}\n                    </span>\n                    р.\n                </div>\n            </div>\n            `}i&&(i.innerHTML="",i.insertAdjacentText("afterbegin",s+" р."))}toggleCodeWordsBlock(){if(this.codeWordsBlock=this.rootElem.querySelector(".page-promotion__codes"),!this.totalPrice)return this.codeWordsBlock.classList.add("none");this.totalPrice>0&&this.codeWordsBlock.classList.remove("none")}handleCodeWords(){a=a.bind(this),n=n.bind(this),o=o.bind(this),i=i.bind(this),this.codeWordsInput=this.rootElem.querySelector(".promotion-code__input");const t=this.codeWordsInput.closest(".promotion-code__input-wrapper"),e=this.rootElem.querySelector(".promotion-code__button"),s=this.rootElem.querySelector(".promotion-code__down");function i(t){"Enter"===t.key&&a()}function n(){t.classList.add("__focus")}function o(){const e=this.codeWordsInput.value;t.classList.remove("__focus"),e?t.classList.remove("__empty"):(t.classList.remove("__inserted-code"),t.classList.add("__empty"))}function a(){switch(this.codeWordsInput.value){default:t.classList.remove("__inserted-code"),t.classList.remove("__valid"),r("");break;case"vsevn1":t.classList.add("__inserted-code"),t.classList.remove("__valid"),r("Извините, срок этой акции истек (до 17.01.2023)");break;case"vsevn2":t.classList.add("__inserted-code"),t.classList.remove("__valid"),r("К сожалению, Вы не можете активировать это кодовое слово, так как не являетесь участником акции");break;case"vsevn3":t.classList.add("__inserted-code"),t.classList.add("__valid"),r("Кодовое слово принято!");break;case"vsevn4":t.classList.add("__inserted-code"),t.classList.remove("__valid"),r("Вы уже активировали это слово ранее. Акция для вас уже активировна, наслаждайтесь покупками.")}}function r(t){s.innerHTML="",s.insertAdjacentHTML("afterbegin",t),t.includes("Кодовое слово принято!")?s.classList.add("green"):s.classList.remove("green")}this.codeWordsInput.addEventListener("focus",n),this.codeWordsInput.addEventListener("blur",o),this.codeWordsInput.addEventListener("keydown",i),e.addEventListener("click",a),o()}createPromotionMore(){function t(t){findClosest(t.target,".promotion-more__list").classList.toggle("none")}this.options.forEach((e=>{const s=e.option.querySelector(".promotion-more");if(!s)return;s.innerHTML="";s.insertAdjacentHTML("afterbegin",'\n                <button class="promotion-more__button" type="button">Показать больше</button>\n                <ul class="promotion-more__list none"></ul>\n            ');const i=s.querySelector(".promotion-more__list");s.querySelector(".promotion-more__button").addEventListener("click",t);const n=findClosest(e.option,".page-promotion__header").querySelectorAll(".promotion-item__description-text");let o="";n.forEach((t=>o+=function(t){return`\n            <li class="promotion-more__item">\n                <div class="promotion-more__item-title">\n                    ${t}\n                </div>\n                <div class="promotion-more__item-value"></div>\n            </li>\n            `}(t.innerHTML))),i.insertAdjacentHTML("afterbegin",o);const a=i.querySelectorAll(".promotion-more__item"),r=e.option.querySelectorAll(".promotion-item__description-text");a.forEach(((t,e)=>{const s=r[e];t.querySelector(".promotion-more__item-value").insertAdjacentHTML("afterbegin",s.innerHTML)}))})),document.addEventListener("click",(t=>{t.target.closest(".promotion-more")||document.querySelectorAll(".promotion-more__list").forEach((t=>t.classList.add("none")))}))}}class ChangeablePricePromotion{constructor(t){this.onInput=this.onInput.bind(this),this.onChange=this.onChange.bind(this),this.rootElem=t;const e=this.rootElem.dataset.promotionOption.split(", ")[0].split("|").map((t=>parseInt(t.replace(/\D/g,""))));this.price=e[0],this.oldPrice=e[1],this.rootElem.removeAttribute("data-promotion-option"),this.input=this.rootElem.querySelector(".promotion-item__amount-input"),this.buttonPlus=this.rootElem.querySelector(".page-promotion__amount-plus"),this.buttonMinus=this.rootElem.querySelector(".page-promotion__amount-minus"),this.min=this.input.getAttribute("min"),this.max=this.input.getAttribute("max"),this.totalBlock=this.rootElem.querySelector(".page-promotion__checkbox-total"),this.input.addEventListener("input",this.onInput),this.input.addEventListener("change",this.onChange),this.buttonPlus.addEventListener("click",(()=>this.mathOperation("+"))),this.buttonMinus.addEventListener("click",(()=>this.mathOperation("-")))}getValue(){const t=this.input.value;return parseInt(t.replace(/\D/g,""))}setTotal(){const t=parseInt(this.input.value)*this.price;this.totalBlock.innerHTML="",this.totalBlock.insertAdjacentText("afterbegin",t)}mathOperation(t="+"){const e=this.getValue();if("+"===t){const t=e+1;if(t>this.max)return;this.input.value=t}if("-"===t){const t=e-1;if(t<this.min)return;this.input.value=t}this.input.dispatchEvent(new Event("change"))}onInput(){let t=parseInt(this.input.value.replace(/\D/g,""));t>this.max&&(this.input.value=this.max),t<this.min&&(this.input.value=this.min),t||(this.input.value=this.min),findInittedInput("#promotion").calcTotalPrice(),this.setTotal()}onChange(){findInittedInput("#promotion").calcTotalPrice(),this.setTotal()}}class Spoiler{constructor(t){this.toggle=this.toggle.bind(this),this.rootElem=t,this.spoilerButton=this.rootElem.querySelector(".spoiler__button"),this.spoilerHideable=this.rootElem.querySelector(".spoiler__hideable"),this.spoilerButton.addEventListener("click",this.toggle),this.rootElem.classList.contains("spoiler--shown")?this.show():this.hide()}toggle(){this.rootElem.classList.contains("spoiler--shown")?this.hide():this.show()}show(){let t=this.getHeight();this.spoilerHideable.style.cssText=`\n            max-height: ${t}px;\n            opacity: 1;\n        `,this.spoilerHideable.style.removeProperty("padding"),this.spoilerHideable.style.removeProperty("margin"),this.rootElem.classList.add("spoiler--shown")}hide(){this.spoilerHideable.style.cssText="\n            padding: 0;\n            margin: 0;\n            opacity: 0;\n            max-height: 0px;\n        ",this.rootElem.classList.remove("spoiler--shown")}getHeight(){let t=this.spoilerHideable.cloneNode(!0);t.style.cssText="position: absolute; z-index: -99; top: -100vh; left: -100vw;",document.body.append(t);let e=t.offsetHeight;return t.remove(),e+10}}class HoverTitle{constructor(t){this.onPointerover=this.onPointerover.bind(this),this.onPointerleave=this.onPointerleave.bind(this),this.rootElem=t,this.text=this.rootElem.getAttribute("data-hover-title"),this.block=createElement("span","hover-title",this.text),this.rootElem.addEventListener("pointerover",this.onPointerover),this.rootElem.addEventListener("pointerleave",this.onPointerleave)}onPointerover(){this.rootElem.append(this.block)}onPointerleave(){this.block.remove()}}function getScrollWidth(){const t=createElement("div","","<div></div>");t.style.cssText="position: absolute; left: -100vw; z-index: -9; overflow: scroll; width: 100px; height: 100px;",t.querySelector("div").style.cssText="height: 250px; width: 100%",document.body.append(t);const e=t.offsetWidth-t.clientWidth;return t.remove(),e}const lockScrollObserver=new MutationObserver((()=>{const t=document.querySelector(".wrapper");document.body.classList.contains("__locked-scroll")?t.style.paddingRight=`${getScrollWidth()}px`:t.style.removeProperty("padding-right")}));lockScrollObserver.observe(document.body,{attributes:!0});let inittingSelectors=[{selector:".cookie",classInstance:Cookie},{selector:".resume__choose",classInstance:ChooseTabs},{selector:"[data-status-dependable-text]",classInstance:StatusDependableText},{selector:"[data-status-dependable-display]",classInstance:StatusDependableDisplay},{selector:".resume__rubricks",classInstance:Rubricks},{selector:"#options",classInstance:Options},{selector:"#promotion",classInstance:PromotionBlock},{selector:"[data-promotion-option*='changeable']",classInstance:ChangeablePricePromotion},{selector:"[data-promotion-about]",classInstance:PromotionAbout},{selector:".spoiler",classInstance:Spoiler},{selector:"[data-hover-title]",classInstance:HoverTitle}];function initInputs(){inittingSelectors.forEach((t=>{const e=t.selector,s=t.classInstance;Array.from(document.querySelectorAll(e)).filter((e=>!Boolean(inittedInputs.find((s=>s.rootElem===e&&s instanceof t.classInstance))))).forEach((e=>{const i=new s(e);t.flag&&(i.instanceFlag=t.flag),inittedInputs.push(i)}))}))}let isInitting=!1;const inittingInputsBodyObserver=new MutationObserver((()=>{isInitting||(isInitting=!0,initInputs(),setTimeout((()=>isInitting=!1),0))}));inittingInputsBodyObserver.observe(document.body,{childList:!0,subtree:!0}),initInputs();class Input{constructor(t){this.onInput=this.onInput.bind(this),this.onFocus=this.onFocus.bind(this),this.onChange=this.onChange.bind(this),this.clear=this.clear.bind(this),this.onDocumentClick=this.onDocumentClick.bind(this),this.typeNumbersOnly=this.typeNumbersOnly.bind(this),this.rootElem=t,this.isRequired=this.rootElem.hasAttribute("data-required"),this.errorMessage=this.rootElem.querySelector(".work-error"),this.wrongValueMessageBlock=this.rootElem.querySelector(".text-input__wrong-value"),this.selectsTransitionDur=300,this.setMaxHeight=!0,this.rootElem.hasAttribute("data-unset-max-height")&&(this.rootElem.removeAttribute("data-unset-max-height"),this.setMaxHeight=!1),this.getSelectsWrap(),document.addEventListener("click",this.onDocumentClick)}getTagLists(){const t=this.rootElem.dataset.tagsSelect;return t?document.querySelectorAll(`[data-tags-list="${t}"]`):null}createControls(){const t=this.inputWrapper.className.split(" ")[0];Array.from(this.inputWrapper.querySelectorAll("."+t+"> div")).concat(Array.from(this.inputWrapper.querySelectorAll("."+t+"> span"))).forEach((t=>{t!==this.input&&!t.classList.contains("selects-wrap")&&!t.classList.contains("selects-wrap-checkbox")&&t.remove()}));const e=this.inputWrapper.querySelector('[class*="selects-wrap"]'),s=`\n            ${e?'<span class="arrow"></span>':""}\n            <span class="cross">\n            <svg>\n                <use xlink:href="#cross-icon"></use>\n            </svg>\n            </span>\n            <div class="prompt-hover__open">Очистить поле?</div>\n        `;this.inputWrapper.insertAdjacentHTML("beforeend",s),e||(this.input.style.paddingRight="50px"),this.clearButton=this.rootElem.querySelector(".cross"),this.clearButton.addEventListener("click",this.clear)}initInput(){this.input.addEventListener("input",this.onInput),this.input.addEventListener("focus",this.onFocus),this.input.addEventListener("change",this.onChange),this.input.addEventListener("blur",this.onChange),this.isNumbersOnly&&this.input.addEventListener("input",this.typeNumbersOnly)}onInput(t){const e=this.input.value;this.selectsWrap&&this.highlitMatches(),e&&this.rootElem.classList.remove("__uncompleted"),e?this.inputWrapper.classList.add("__has-value"):this.inputWrapper.classList.remove("__has-value"),this.checkCompletion(t)}onFocus(){this.openSelects()}onChange(){const t=this.input.value;if(this.maskData){this.getClearedFromMaskValue(t)||(this.input.value="")}this.rootElem.classList.remove("__wrong-value"),this.checkCompletion()}clear(){this.input.value="",this.input.dispatchEvent(new Event("input")),this.input.dispatchEvent(new Event("change"))}onDocumentClick(t){t.target!==this.input&&this.closeSelects()}typeNumbersOnly(t){const e=t.target,s=e.value;e.value=s.replace(/\D/g,"")}getSelectsWrap(){if(this.selectsWrap=this.rootElem.querySelector(".selects-wrap")||this.rootElem.querySelector(".selects-wrap-checkbox"),!this.selectsWrap)return;let t=".selects-wrap__option";return this.selectsWrap.classList.contains("selects-wrap-checkbox")&&(t=".selects-checkbox"),this.selectValues=Array.from(this.selectsWrap.querySelectorAll(t)),this.selectValues.length?void 0:(this.selectValues=null,void(this.selectsWrap=null))}getSelectsHeight(){const t=this.selectsWrap.cloneNode(!0),e=this.selectsWrap.parentNode.offsetWidth;t.querySelectorAll(".none").forEach((t=>t.classList.remove("none"))),t.style.cssText=`width: ${e}px; overflow: visible; max-height: unset; visibility: visible; position: absolute;`,document.body.append(t);const s=t.offsetHeight;return t.remove(),s}closeSelects(){this.selectsWrap&&(this.rootElem.classList.remove("open-selects"),this.selectsWrap.style.maxHeight="0",this.selectsWrap.style.removeProperty("visibility"),this.selectsWrap.style.overflow="hidden",this.selectsWrap.style.cssText="padding: 0; margin: 0;")}openSelects(){if(!this.selectsWrap)return;this.rootElem.classList.add("open-selects");const t=this.getSelectsHeight();setTimeout((()=>{this.selectsWrap.style.cssText="visibility: visible; overflow: hidden;",this.setMaxHeight&&(this.selectsWrap.style.maxHeight=`${t}px`),setTimeout((()=>{this.selectsWrap.style.removeProperty("transition"),this.selectsWrap.style.removeProperty("overflow")}),this.selectsTransitionDur)}),0)}highlitMatches(t=null){const e=this.input.value.toLowerCase().trim();!!Boolean(this.selectValues.find((t=>{const e=t.text.trim().toLowerCase(),s=this.input.value.toLowerCase().trim();return e.includes(s)})))||e.includes("выбрано")||e.includes("Выбрано")?this.selectsWrap.classList.remove("none"):this.selectsWrap.classList.add("none"),t||(t=this.selectValues.find((t=>t.text.toLowerCase().trim()===e))),t?this.selectValues.forEach((t=>{t.node.classList.remove("none"),this.setHighlightedText(t.text,t)})):this.selectValues.forEach((t=>{const s=t.text,i=s.toLowerCase().trim();if(i.includes(e)){t.node.classList.remove("none");const n=i.indexOf(e),o=n+e.length;let a=s.slice(0,n)+`<span class="highlight">${s.slice(n,o)}</span>`+s.slice(o);this.setHighlightedText(a,t)}else this.input.value.includes("выбрано")||this.input.value.includes("Выбрано")||t.node.classList.add("none")}))}checkCompletion(){return this.isCompleted=Boolean(this.rootElem.querySelector("input:checked")),this.isCompleted}createTag(t){const e=createElement("li","tags-list__item",`\n            <div class="tags-list__item-text">${t}</div>\n            <svg class="tags-list__item-cross"><use xlink:href="#cross-icon"></use></svg>\n        `),s=e.querySelector(".tags-list__item-cross");return{tag:e,removeButton:s}}}class TextInput extends Input{constructor(t){super(t),this.onMaskInput=this.onMaskInput.bind(this),this.wrapInMask=this.wrapInMask.bind(this),this.init()}init(){if(this.input=this.rootElem.querySelector(".text-input__input"),this.mask=this.input.dataset.inputMask,this.completionMask=this.input.dataset.completionMask,this.isNumbersOnly=this.input.hasAttribute("data-numbers-only"),this.inputWrapper=this.rootElem.querySelector(".text-input__wrapper"),this.inputWrapper||(this.inputWrapper=this.rootElem),this.rootElem.hasAttribute("data-select-controls")&&this.createControls(),this.closeSelects(),this.getSelectsWrap(),this.initInput(),this.mask&&(this.createMask(),this.input.addEventListener("input",this.onMaskInput)),this.wrongValueMessageBlock){this.wrongValueMessageBlock.querySelector(".wrong-value__cross").addEventListener("click",(()=>{this.rootElem.classList.remove("__wrong-value")}))}}createControls(){const t=this.inputWrapper.className.split(" ")[0];Array.from(this.inputWrapper.querySelectorAll("."+t+"> div")).concat(Array.from(this.inputWrapper.querySelectorAll("."+t+"> span"))).forEach((t=>{t===this.input||t.classList.contains("selects-wrap")||t.classList.contains("text-input__wrong-value")||t.remove()}));const e=this.inputWrapper.querySelector('[class*="selects-wrap"]'),s=`\n            ${e?'<span class="arrow"></span>':""}\n            <span class="cross">\n            <svg>\n                <use xlink:href="#cross-icon"></use>\n            </svg>\n            </span>\n            <div class="prompt-hover__open">Очистить поле?</div>\n        `;this.inputWrapper.insertAdjacentHTML("beforeend",s),e||(this.input.style.paddingRight="50px"),this.clearButton=this.rootElem.querySelector(".cross"),this.clearButton.addEventListener("click",this.clear)}checkCompletion(t){const e=this.input.value;if(this.mask){const t=new RegExp(this.mask);this.isCompleted=Boolean(e.match(t))}else if(this.completionMask){const t=new RegExp(this.completionMask);this.isCompleted=Boolean(e.match(t))}else this.isCompleted=Boolean(e);const s=!t||t&&"input"!==t.type;return!this.isCompleted&&e?this.rootElem.classList.add("__wrong-value"):(s&&this.input.value&&this.rootElem.classList.remove("__uncompleted"),this.rootElem.classList.remove("__wrong-value")),this.isCompleted}getSelectsWrap(){super.getSelectsWrap(),this.selectValues&&(this.selectValues=this.selectValues.map((t=>({node:t,text:t.textContent.trim()||val.innerText}))),this.selectValues.forEach((t=>{t.node.addEventListener("click",(()=>{this.input.value=t.text,this.input.dispatchEvent(new Event("input")),this.input.dispatchEvent(new Event("change")),this.getTagLists()&&this.addTag()}))})))}createMask(){new RegExp(this.mask);let t=this.mask.split(/(\s)/);1===t.length&&(t=this.mask.split(/(\.+)/));const e=t.map((t=>new RegExp(t))),s=t.map((t=>t.replace("\\",""))),i=s.join("");this.maskData={regexps:e,substrings:s,unspacedMask:i}}onMaskInput(t){if(t.inputType&&t.inputType.includes("deleteContent"))return;const e=this.input.value;if("insertFromPaste"===t.inputType)return void setTimeout((()=>{let t=this.getClearedFromMaskValue(e);this.isNumbersOnly&&(t=t.replace(/[^0-9+()\s-]/g,"")),this.wrapInMask(t)}),100);let s=0;for(let t=0;t<this.maskData.regexps.length;t++){const i=this.maskData.regexps[t],n=this.maskData.substrings[t].length,o=e.slice(s,s+n);if(s+=n,o&&!o.match(i)){let t=this.getClearedFromMaskValue(e);this.wrapInMask(t);break}}}getClearedFromMaskValue(t){return this.maskData.regexps.forEach(((e,s)=>{this.maskData.substrings[s].includes(".")||(t=t.replace(e,""))})),t}wrapInMask(t){let e=this.maskData.unspacedMask;t.split("").forEach((t=>e=e.replace(".",t)));const s=e.includes(".")?e.indexOf("."):null;s&&(e=e.slice(0,s)),this.input.value=e.replace("\\","")}setHighlightedText(t,e){e.node.innerHTML=t}addTag(){this.getTagLists().forEach((t=>{const e=this.createTag(this.input.value);t.querySelectorAll(".tags-list__item").forEach((t=>t.remove())),t.append(e.tag),e.removeButton.addEventListener("click",this.removeTag.bind(this))}))}removeTag(){this.getTagLists().forEach((t=>{t.querySelectorAll(".tags-list__item").forEach((t=>t.remove())),this.input.value="",this.input.dispatchEvent(new Event("change"))}))}}class TextInputPhone extends TextInput{constructor(t){super(t),this.mask="\\+7 \\( ... \\) ... - .. - ..",this.createMask(),this.input.addEventListener("focus",this.onMaskInput),this.input.addEventListener("input",this.onMaskInput)}typeNumbersOnly(t){const e=t.target,s=e.value;e.value=s.replace(/[^0-9+()\s-]/g,"");const i=s.lastIndexOf("+");i>0&&(e.value=e.value.slice(0,i)+e.value.slice(i+1))}onMaskInput(t){"focus"!==t.type||this.input.value||(this.input.value="+7 ("),t.inputType&&t.inputType.includes("deleteContent")&&this.mask.startsWith("8")&&this.input.value.length<=5&&(this.input.value="");let e=this.input.value;let s=this.mask.match(/\s/)?6:4;const i=e.endsWith("8")&&e.length<=s||e.startsWith("8"),n=e.startsWith("+7")&&!this.mask.includes("+7")||!e;i&&this.mask.includes("+7")?(this.mask="8 800 ... - .. - ..",this.createMask(),this.input.setAttribute("maxlength","19"),this.input.value.includes("+7")&&(this.input.value=this.input.value.replace("+7","").replace("(","").replace(")",""))):(n||this.mask.startsWith("8")&&t.inputType&&t.inputType.includes("deleteContent"))&&(this.mask="\\+7 \\( ... \\) ... - .. - ..",this.createMask(),this.input.setAttribute("maxlength","24")),super.onMaskInput(t),(this.mask.includes("+7")&&"7"==e[5]||"7"==e[4])&&(this.input.value=this.input.value.slice(0,5)+this.input.value.slice(6))}}class TimeScheduleItem{constructor(t){this.onCheckboxChange=this.onCheckboxChange.bind(this),this.onAddLunchClick=this.onAddLunchClick.bind(this),this.rootElem=t,this.isRequired=this.rootElem.hasAttribute("data-required"),this.inputs=Array.from(this.rootElem.querySelectorAll(".time-schedule__select")).map(((t,e)=>{const s=inittedInputs.find((e=>e.rootElem===t))||new TimeScheduleInput(t);return 0===e&&s.setDefaultTime("00:30"),1===e&&s.setDefaultTime("19:00"),s})),this.checkboxes=Array.from(this.rootElem.querySelectorAll(".time-schedule__checkbox input[type='checkbox']")),this.checkboxes.forEach((t=>{t.addEventListener("change",this.onCheckboxChange),this.setCheckedCheckbox(t)})),this.addLunchButton=this.rootElem.querySelector(".time-schedule__button--lunch"),this.addLunchButton&&this.addLunchButton.addEventListener("click",this.onAddLunchClick)}onCheckboxChange(t){const e=t.target;setTimeout((()=>this.setCheckedCheckbox(e)),100)}setCheckedCheckbox(t){if(t.checked){const e=t.closest(".time-schedule__checkboxes"),s=t.getAttribute("name");let i;if("misc"===t.value){const o=Array.from(t.closest(".time-schedule").querySelectorAll(".time-schedule__item:not(.time-schedule__item--misc)"));i=o.map((t=>({elem:t})))}else i=[{elem:findClosest(t,".time-schedule__body")},{elem:findClosest(t,".time-schedule__button")}];function n(){t.checked||(t.removeEventListener("change",n),i.forEach((t=>t.anchor.replaceWith(t.elem))),e.classList.remove("__active"))}Array.from(document.querySelectorAll(`[name="${s}"]`)).filter((e=>e!==t)).forEach((t=>{t.checked=!1,i.push({elem:t.closest(".time-schedule__checkbox")})})),i.forEach((t=>{t.anchor=createElement("div","none"),t.elem.replaceWith(t.anchor)})),e.classList.add("__active"),t.addEventListener("change",n)}}checkCompletion(){if(this.checkboxes.find((t=>t.checked)))this.isCompleted=!0,this.rootElem.classList.remove("__uncompleted");else{const t=[],e=this.inputs.filter((e=>{const s=e.checkCompletion();return s&&t.push(e),!s}));this.isCompleted=Boolean(e.length<1),e.forEach((t=>t.rootElem.classList.add("__uncompleted"))),t.forEach((t=>t.rootElem.classList.remove("__uncompleted")))}return this.isCheckingHandler||this.setCheckingCompletionHandler(),setTimeout((()=>{this.rootElem.classList.remove("__uncompleted")}),0),this.isCompleted}setCheckingCompletionHandler(){this.isCheckingHandler||(this.inputs.forEach((t=>{t.input.addEventListener("input",(()=>{t.checkCompletion(),this.checkCompletion()}))})),this.checkboxes.forEach((t=>t.addEventListener("change",(()=>{this.inputs.forEach((t=>t.checkCompletion())),this.checkCompletion()})))),this.isCheckingHandler=!0)}onAddLunchClick(){inittedInputs.filter((t=>t.rootElem.closest(".time-schedule__item")===this.rootElem&&t instanceof TimeScheduleInput)).filter((t=>!this.inputs.includes(t))).forEach(((t,e)=>{0===e&&t.setDefaultTime("12:00"),1===e&&t.setDefaultTime("13:00")}))}}class TimeScheduleInput extends TextInput{constructor(t){super(t),this.createSelectOptions(),this.createControls(),this.init(),this.input.addEventListener("input",this.typeNumbersOnly),this.input.setAttribute("maxlength","5")}createSelectOptions(){let t=function(){let t="";for(let s=0;s<24;s++){let i=s<10?"0"+s.toString():s.toString();["00","30"].forEach((s=>t+=e(i,s)))}return t}();function e(t,e){return`\n                <p class="selects-wrap__option small-text">\n                    ${t}:${e}\n                </p>\n            `}this.selectsWrap=createElement("div","selects-wrap",t),this.inputWrapper.append(this.selectsWrap)}checkCompletion(){const t=this.input.value;return this.isCompleted=Boolean(this.selectValues.find((e=>e.text==t))),this.isCompleted}setDefaultTime(t="00:00"){if(this.selectValues){const e=this.selectValues.find((e=>e.text===t))||this.selectValues.find((e=>e.text.includes(t.slice(0,2))));if(!e)return;e.node.dispatchEvent(new Event("click"))}}typeNumbersOnly(t){const e=t.target,s=e.value;e.value=s.replace(/[^0-9:]/g,"")}}class Textarea{constructor(t){this.onInput=this.onInput.bind(this),this.rootElem=t,this.input=this.rootElem.querySelector(".textarea-wrapper__input"),this.maxlength=this.input.getAttribute("maxlength"),this.minlength=this.input.dataset.minlength,this.createMaxText(),this.onInput(),this.input.addEventListener("input",this.onInput)}createMaxText(){const t=this.rootElem.querySelector(".textarea-wrapper__max-text");t&&t.remove();const e=`\n        <div class="textarea-wrapper__max-text">\n            <span class="textarea-wrapper__input-count"></span>\n            ${this.maxlength?'из <span class="textarea-wrapper__max-count"></span>':""}\n            ${this.minlength?`(минимум ${this.minlength})`:""}\n        </div>\n        `;this.rootElem.insertAdjacentHTML("beforeend",e),this.inputCount=this.rootElem.querySelector(".textarea-wrapper__input-count"),this.maxCount=this.rootElem.querySelector(".textarea-wrapper__max-count"),this.maxlength&&(this.maxCount.innerHTML=this.maxlength)}onInput(){const t=this.input.value,e=t?t.length.toString():"0";this.inputCount.innerHTML=e}}class TagsList{constructor(t){this.removeTags=this.removeTags.bind(this),this.setEmptyOrFilledState=this.setEmptyOrFilledState.bind(this),this.rootElem=t,this.removeButton=this.rootElem.querySelector(".tags-list__remove-button"),this.removeButton&&this.removeButton.addEventListener("click",this.removeTags),this.setEmptyOrFilledState();new MutationObserver(this.setEmptyOrFilledState).observe(this.rootElem,{childList:!0})}getTags(){return Array.from(this.rootElem.querySelectorAll(".tags-list__item"))}setEmptyOrFilledState(){this.getTags().length<1?this.rootElem.classList.add("tags-list--empty"):this.rootElem.classList.remove("tags-list--empty")}removeTags(){const t=new Event("click");this.getTags().forEach((e=>{const s=e.querySelector(".tags-list__item-cross");s&&!s.classList.contains("none")&&s.dispatchEvent(t)}))}}class TextInputRegions extends TextInput{constructor(t){super(t),this.createControls(),this.setRegions()}setRegions(){fetch("/vsevn-ad/json/regions.json").then((t=>t.json())).then((t=>{let e="";this.selectsWrap||(this.selectsWrap=this.rootElem.querySelector(".selects-wrap")),t.forEach((t=>e+=function(t){return`<p class="selects-wrap__option small-text">${t}</p>`}(t))),this.selectsWrap.innerHTML="",this.selectsWrap.insertAdjacentHTML("afterbegin",e),this.getSelectsWrap()}))}}class TextInputCheckboxes extends Input{constructor(t){super(t),this.onCbDisableChange=this.onCbDisableChange.bind(this),this.apply=this.apply.bind(this),this.removeTag=this.removeTag.bind(this),this.input=this.rootElem.querySelector(".selects-input-checkbox__input"),this.ariaLabel=this.input.getAttribute("aria-label")||"",this.applyButton=this.rootElem.querySelector(".selects-wrap-checkbox__button"),this.checkboxesBlock=this.rootElem.querySelector(".selects-wrap-checkbox"),this.checked=[],this.isCheckRequired=this.rootElem.dataset.requiredCheck,this.inputWrapper=this.rootElem.querySelector(".selects-input-checkbox__wrapper"),this.inputWrapper||(this.inputWrapper=this.rootElem),this.rootElem.hasAttribute("data-select-controls")&&this.createControls(),this.getCheckboxes(),this.checkboxes.forEach((t=>t.value=t.value.replace(/\s\s/g,""))),this.closeSelects(),this.initInput(),this.applyButton&&this.applyButton.addEventListener("click",this.apply)}getCheckboxes(){Array.isArray(this.checkboxes)||(this.checkboxes=[]);Array.from(this.checkboxesBlock.querySelectorAll(".selects-checkbox")).filter((t=>!this.checkboxes.includes(t))).forEach((t=>{t.value=t.value.replace(/\s\s/g,""),this.checkboxes.push(t),this.applyButton||t.addEventListener("change",this.apply)})),this.checkboxesDisable=this.checkboxes.filter((t=>t.hasAttribute("data-oncheck-disable"))).map((t=>{const e=t.dataset.oncheckDisable.split(", ").map((t=>parseInt(t))).filter((e=>e!==this.checkboxes.indexOf(t)&&(e||0===e))).map((t=>this.checkboxes[t]));return t.removeAttribute("data-oncheck-disable"),t.addEventListener("change",this.onCbDisableChange),{input:t,disablingInputs:e}}))}apply(t=null){const e=!t||t&&t.isTrusted;this.checked=this.checkboxes.filter((t=>t.checked)),this.checked.length<1&&(this.input.value=""),1===this.checked.length&&(this.input.value=this.checked[0].value),this.checked.length>1&&(this.ariaLabel?this.input.value=this.ariaLabel+" (выбрано: "+this.checked.length+")":this.input.value="Выбрано: "+this.checked.length),e&&(this.input.dispatchEvent(new Event("change")),this.input.dispatchEvent(new Event("input"))),this.applyButton&&this.closeSelects(),this.getTagLists()&&e&&this.addTags(),this.rootElem.dispatchEvent(new CustomEvent("select-change"))}onCbDisableChange(t){const e=t.target,s=this.checkboxesDisable.find((t=>t.input===e));if(!s)return;const i=s.disablingInputs;e.checked?i.forEach((t=>{t.checked=!1,t.setAttribute("disabled",!0),t.closest("label").setAttribute("data-disabled",!0)})):i.forEach((t=>{t.removeAttribute("disabled"),t.closest("label").removeAttribute("data-disabled")}))}onDocumentClick(t){t.target===this.input||t.target===this.checkboxesBlock||t.target.closest(".selects-wrap-checkbox")||this.closeSelects()}getSelectsWrap(){super.getSelectsWrap(),this.selectValues&&(this.selectValues=this.selectValues.map((t=>({node:t.closest("label"),text:t.value.replace(/\s\s/g,""),textNode:t.closest("label").querySelector(".text")}))))}closeSelects(){super.closeSelects(),this.checkboxes.forEach((t=>{const e=this.checked.includes(t);t.checked=!!e}))}clear(){super.clear(),this.checkboxes.forEach((t=>{t.checked&&(t.checked=!1,this.apply())}))}highlitMatches(){const t=this.input.value.includes("выбрано");super.highlitMatches(t)}setHighlightedText(t,e){e.textNode.innerHTML=t}addTags(){function t(t){const e=t.target.closest(".tags-list__item");this.removeTag(e)}t=t.bind(this),Array.isArray(this.tags)||(this.tags=[]),this.checked.forEach((e=>{const s=this.tags.find((t=>t.value===e.value));if(s)return;const i={input:e,value:e.value,tags:[]};this.getTagLists().forEach((s=>{const n=this.createTag(e.value),o=n.tag;s.append(o),i.tags.push(o),n.removeButton.addEventListener("click",t.bind(this))})),this.tags.push(i)})),function(){this.tags.forEach((t=>{t.input.checked||t.tags.forEach((t=>this.removeTag(t)))}))}.call(this)}removeTag(t){const e=this.tags.find((e=>e.tags.indexOf(t)>=0));if(!e)return t.remove();e.input.checked=!1,e.input.dispatchEvent(new Event("change")),e.tags.forEach((t=>t.remove())),this.tags.splice(this.tags.indexOf(e),1)}setValue(t){setTimeout((()=>{if(t=t.replace(/\s\s/g,""),!this.selectValues)return void setTimeout((()=>this.setValue(t)),100);const e=this.selectValues.find((e=>e.text===t));if(!e)return;e.node.querySelector("input").checked=!0,this.apply()}),0)}checkCompletion(){return this.isCheckRequired?this.isCompleted=Boolean(this.rootElem.querySelector("input:checked")):this.isCompleted=Boolean(this.input.value),this.isCompleted}}class TextInputCheckboxesRegion extends TextInputCheckboxes{constructor(t){super(t),this.createControls(),this.setRegions()}setRegions(){fetch("/vsevn-ad/json/regions.json").then((t=>t.json())).then((t=>{let e="";this.selectsWrap||(this.selectsWrap=this.rootElem.querySelector(".selects-wrap-checkbox")),t.forEach((t=>e+=function(t){return`\n            <label class="flex checkboxs__items_item">\n                <input class="mr-5 checkbox selects-checkbox" type="checkbox" value="${t}">\n                <span class="checkmark">\n                <img src="img/checkmark.png" alt="checkmark">\n                <img class="checkmark-hover-img" src="img/check_mark_hover.png" alt="checkmark-hover">\n                </span>\n                <span class="text small-text">${t}</span>\n            </label>\n            `}(t))),this.selectsWrap.innerHTML="",this.selectsWrap.insertAdjacentHTML("afterbegin",e),this.getSelectsWrap(),this.getCheckboxes()}))}}class DateInput{constructor(t){if(this.onInputFocus=this.onInputFocus.bind(this),this.onInputBlurOrChange=this.onInputBlurOrChange.bind(this),this.onInput=this.onInput.bind(this),this.onKeydown=this.onKeydown.bind(this),this.moveToLeft=this.moveToLeft.bind(this),this.onLabelClick=this.onLabelClick.bind(this),this.rootElem=t,this.isRequired=this.rootElem.hasAttribute("data-required"),this.inputs=Array.from(this.rootElem.querySelectorAll(".date-inputs__input")),this.datesBlock=this.rootElem.closest(".dates-inputs"),this.wrongValueMessageBlock=this.rootElem.querySelector(".text-input__wrong-value"),this.label=this.rootElem.querySelector(".date-inputs__label"),this.currentYear=(new Date).getFullYear(),this.getMinmaxYears(),this.inputs.forEach((t=>{t.addEventListener("focus",this.onInputFocus),t.addEventListener("blur",this.onInputBlurOrChange),t.addEventListener("input",this.onInput),t.addEventListener("keydown",this.onKeydown)})),this.inputs[2].addEventListener("keydown",this.moveToLeft),this.label&&this.label.addEventListener("click",this.onLabelClick),this.wrongValueMessageBlock){this.wrongValueMessageBlock.querySelector(".wrong-value__cross").addEventListener("click",(()=>{this.rootElem.classList.remove("__wrong-value")}))}}getMinmaxYears(){s=s.bind(this);let t=this.rootElem.dataset.minmaxYears;t||(t="min:1900; max:0");const e=assignPropertiesToObj(t.split("; "));function s(t){const e=t.startsWith("+")||t.startsWith("-"),s=1===t.replace(/\D/g,"").length&&t.includes("0"),i=!e&&!s&&4===t.length;if(e){const e=parseInt(t.replace(/\D/g,""));if(t.startsWith("+"))return this.currentYear+e;if(t.startsWith("-"))return this.currentYear-e}return s?this.currentYear:i?parseInt(t.replace(/\D/g,"")):void 0}this.minYear=s(e.min||"1900"),this.maxYear=s(e.max||"0"),this.rootElem.removeAttribute("data-minmax-years")}onLabelClick(){(this.inputs.find((t=>{const e=parseInt(t.getAttribute("maxlength"));return t.value.length<e}))||this.inputs[2]).focus()}onInputFocus(){this.rootElem.classList.add("__focus")}onInputBlurOrChange(){this.rootElem.classList.remove("__focus"),this.day=parseInt(this.inputs[0].value),this.month=parseInt(this.inputs[1].value),this.year=parseInt(this.inputs[2].value),this.validateDate()}onInput(t){const e=t.target,s=e.value;e.value=s.replace(/\D/g,"");const i=parseInt(e.getAttribute("maxlength"));if(e.value.length>=i){const t=this.inputs.indexOf(e),s=this.inputs[t+1];s&&s.focus()}this.rootElem.classList.contains("__uncomplted")&&this.checkCompletion()}moveToLeft(t){const e=t.target,s=this.inputs.findIndex((t=>t===e)),i=this.inputs[s-1];let n=this.inputs.map((t=>t.value)).join("");const o=this.inputs.filter(((t,e)=>e<s));if(t.key){n+=t.key;const a=o.find((t=>t.value.length<t.getAttribute("maxlength")));e.value.length==e.getAttribute("maxlength")&&this.inputs.length-1===s&&i&&a&&!n.match(/\D/g)&&(this.inputs[2].value=n.slice(-4),this.inputs[1].value=n.slice(-6,-4),this.inputs[0].value=n.slice(-8,-6))}}onKeydown(t){const e=t.target,s=this.inputs.findIndex((t=>t===e)),i=this.inputs[s+1],n=this.inputs[s-1];if("Backspace"===t.code&&!e.value&&n&&n.focus(),t.code.includes("Arrow")&&e.selectionStart===e.selectionEnd){const s="ArrowRight"===t.code&&e.selectionEnd===e.value.length&&i,o="ArrowLeft"===t.code&&0===e.selectionStart&&n;s&&i.focus(),o&&n.focus()}this.replaceNextValueSymbol(t)}replaceNextValueSymbol(t){const e=t.target;if(t.key.length>1||e.selectionStart!==e.selectionEnd)return;const s=e.selectionStart,i=e.getAttribute("maxlength");e.value.length==i&&(e.value=e.value.slice(0,s),setTimeout((()=>{e.selectionStart=e.selectionEnd=s+1}),0))}checkCompletion(){return this.isCompleted=this.validateDate().isValid,this.isCompleted}validateDate(){let t;1!==this.month&&3!==this.month&&5!==this.month&&7!==this.month&&8!==this.month&&10!==this.month&&12!==this.month||(t=this.day<=31),t=2===this.month?this.day<=28:this.day<=30;const e=this.month<=12&&this.month>=1,s=this.year<=this.maxYear&&this.year>=this.minYear,i=t&&e&&s;if(3===this.inputs.filter((t=>t.value)).length)if(i)this.rootElem.classList.remove("__uncompleted"),this.datesBlock&&this.datesBlock.classList.remove("__uncompleted"),this.rootElem.classList.remove("__wrong-value");else{this.rootElem.classList.add("__uncompleted"),this.datesBlock&&this.datesBlock.classList.add("__uncompleted"),this.rootElem.classList.add("__wrong-value");let i="";t?e||(i="Неверно указан месяц"):i=e?"Неверно указан день":"Неверно указан день, месяц",!s&&t&&e?i+=`Неверно указан год. Минимальное значение - ${this.minYear}, максимальное - ${this.maxYear}.`:s||(i+=` и год. Минимальное значение года - ${this.minYear}, максимальное - ${this.maxYear}`);this.wrongValueMessageBlock.querySelector(".wrong-value__text").innerHTML=i}return{validDay:t,validMonth:e,validYear:s,isValid:i}}}class BirthdateInput extends DateInput{constructor(t){super(t),this.getAgeAndZodiacClasses(),this.zodiacSigngs=[{name:"Водолей",startMonth:1,startDay:21,endDay:18,iconName:"aquarius"},{name:"Рыбы",startMonth:2,startDay:19,endDay:20,iconName:"pisces"},{name:"Овен",startMonth:3,startDay:21,endDay:19,iconName:"aries"},{name:"Телец",startMonth:4,startDay:20,endDay:20,iconName:"taurus"},{name:"Близнецы",startMonth:5,startDay:21,endDay:20,iconName:"gemini"},{name:"Рак",startMonth:6,startDay:21,endDay:22,iconName:"cancer"},{name:"Лев",startMonth:7,startDay:23,endDay:22,iconName:"leo"},{name:"Дева",startMonth:8,startDay:23,endDay:22,iconName:"virgo"},{name:"Весы",startMonth:9,startDay:23,endDay:22,iconName:"libra"},{name:"Скорпион",startMonth:10,startDay:23,endDay:21,iconName:"scorpio"},{name:"Стрелец",startMonth:11,startDay:22,endDay:21,iconName:"sagittarius"},{name:"Козерог",startMonth:12,startDay:22,endDay:20,iconName:"capicorn"}]}getMinmaxYears(){this.minYear=this.currentYear-90,this.maxYear=this.currentYear-14}onInputBlurOrChange(){super.onInputBlurOrChange(),this.setZodiacAndAge()}getAgeAndZodiacClasses(){setTimeout((()=>{this.zodiacInput=inittedInputs.find((t=>{if(t instanceof TextInput!=0)return t.rootElem.classList.contains("text-input--zodiac")})),this.ageInput=inittedInputs.find((t=>{if(t instanceof TextInput!=0)return t.rootElem.classList.contains("text-input--age")}))}),0)}validateDate(){return{isValid:super.validateDate("Пожалуйста, укажите корректную дату рождения.").isValid}}setZodiacAndAge(){const t=this.zodiacSigngs.filter((t=>t.startMonth==this.month||t.startMonth+1==this.month)).find(((t,e,s)=>{const i=s[e+1];return!i||(this.day>=t.startDay&&this.day<=i.endDay||(this.day<t.startDay||void 0))})),e=t?t.name:"",s=new Date,i=s.getMonth()+1,n=s.getDate()+1;let o=s.getFullYear()-this.year;if((this.month>i||this.month===i&&this.day>n)&&o--,!e||!o||!this.validateDate())return void this.unsetZodiacAndAge();let a=this.zodiacInput.input.parentNode.querySelector("svg");a||(a='<svg><use xlink:href="#"></use></svg>',this.zodiacInput.input.parentNode.insertAdjacentHTML("afterbegin",a),a=this.zodiacInput.input.parentNode.querySelector("svg")),a.querySelector("use").setAttribute("xlink:href",`#${t.iconName}`),this.zodiacInput.rootElem.classList.add("text-input--with-icon"),this.zodiacInput.input.value=e,this.ageInput.input.value=o,this.zodiacInput.input.dispatchEvent(new Event("change")),this.ageInput.input.dispatchEvent(new Event("change"))}unsetZodiacAndAge(){const t=this.zodiacInput.input.parentNode.querySelector("svg");t&&t.remove(),this.zodiacInput.rootElem.classList.remove("text-input--with-icon"),this.zodiacInput.input.value="",this.ageInput.input.value="",this.zodiacInput.input.dispatchEvent(new Event("change")),this.ageInput.input.dispatchEvent(new Event("change"))}checkCompletion(){super.checkCompletion("Пожалуйста, укажите дату рождения")}}class RadioWrapper{constructor(t){this.onChange=this.onChange.bind(this),this.rootElem=t,this.isRequired=this.rootElem.hasAttribute("data-required"),this.inputs=this.rootElem.querySelectorAll("input[type='radio']"),this.inputs.forEach((t=>t.addEventListener("change",this.onChange)))}checkCompletion(){const t=this.rootElem.querySelector("input:checked");return this.isCompleted=Boolean(t),this.isCompleted}onChange(){this.rootElem.querySelector("input:checked")&&this.rootElem.classList.remove("__uncompleted")}}class PageInputButtons{constructor(t){this.onChange=this.onChange.bind(this),this.rootElem=t,this.isRequired=this.rootElem.hasAttribute("data-required"),this.inputWrappers=Array.from(this.rootElem.querySelectorAll(".radios-item__radios")),this.requiredInputWrappers=this.inputWrappers.filter((t=>!t.hasAttribute("data-optional"))),this.inputWrappers.forEach((t=>t.addEventListener("change",this.onChange)))}checkCompletion(){this.checkInputsCompletion();if(this.getUncheckedRequired().length<1){const t=this.requiredInputWrappers.find((t=>Boolean(t.querySelector("input:checked"))));if(!t)return this.isCompleted=!0,this.isCompleted;const e=t.querySelector("input:checked").closest(".radios-item__radios").querySelector(".tags-list");if(!e)return this.isCompleted=!0,this.isCompleted;if(e.querySelectorAll(".tags-list__item").length<1){this.isCompleted=!1;const t=new MutationObserver((()=>{e.querySelectorAll(".tags-list__item").length<1||(t.disconnect(),this.checkCompletion())}));return t.observe(e,{childList:!0}),this.isCompleted}this.isCompleted=!0}else this.isCompleted=!1;return this.isCompleted}checkInputsCompletion(){const t=this.getUncheckedRequired(),e=this.inputWrappers.filter((e=>!t.includes(e)));t.forEach((t=>t.classList.add("__uncompleted"))),e.forEach((t=>t.classList.remove("__uncompleted"))),t.length<1&&this.rootElem.classList.remove("__uncompleted")}getUncheckedRequired(){return this.requiredInputWrappers.filter((t=>!t.querySelector("input:checked")))}onChange(){this.rootElem.classList.contains("__uncompleted")&&this.checkInputsCompletion()}}class AddFieldButton{constructor(t){this.onClick=this.onClick.bind(this),this.rootElem=t,this.counter=2,this.addedFields=[],this.getData(),this.rootElem.addEventListener("click",this.onClick)}getData(){const t=this.rootElem.dataset.addField.split("; ");this.insertToBlock=findClosest(this.rootElem,t[2]);const e=parseInt(t[1]);this.maxFieldsRepeat=e>0?e:1,this.isBefore="true"===t[3];const s=t[0];if(s.startsWith("{")&&s.endsWith("}")){const t=s.replace("{","").replace("}","");this.selectors=t.split(", "),this.cloneRefList=this.selectors.map((t=>findClosest(this.rootElem,t))),this.cloneRefList.forEach(i)}else this.selectors=s,this.cloneRef=findClosest(this.rootElem,this.selectors),this.cloneRef&&i(this.cloneRef);function i(t){t.hasAttribute("data-addfield-hide")&&(t.removeAttribute("data-addfield-hide"),t.remove())}this.rootElem.removeAttribute("data-add-field")}onClick(){this.addField()}addField(){if(!(this.addedFields.length>this.maxFieldsRepeat)){if(t=t.bind(this),this.cloneRef){const e=this.cloneRef.cloneNode(!0);t(e),this.addedFields.push(e);const s=this.createRemoveButton();e.append(s),s.addEventListener("click",(()=>this.removeField(e)));const i=e.querySelector(".add");i&&i.remove()}else if(this.cloneRefList){const e=this.cloneRefList.map((t=>t.cloneNode(!0)));e.forEach((e=>t(e))),this.addedFields.push(e);const s=this.createRemoveButton();s.addEventListener("click",(()=>{this.removeField(e[0]),s.remove()})),e[0].parentNode.append(s),e.forEach((t=>{const e=t.querySelector(".add");e&&e.remove()}))}this.addedFields.length>=this.maxFieldsRepeat&&this.rootElem.classList.add("none")}function t(t){this.replaceUniqueAttributes(t),this.replaceValue(t),this.insertToBlock?this.isBefore?this.insertToBlock.before(t):this.insertToBlock.after(t):this.rootElem.before(t)}}replaceUniqueAttributes(t,e=!1){function s(t,s){const i=t.getAttribute(s);if(!i)return;let n;if(e){let t=i.match(/\d+\b/);if(!t)return;const e=i.indexOf(t);if(t=parseInt(t[0]),t<=0||t==1/0)return;let s=t-1;n=i.slice(0,e)+s.toString()}else n=i.trim().replace(/\d\b/,"").replace(/\-\b/,"")+"-"+this.counter.toString();t.setAttribute(s,n)}s=s.bind(this),t.querySelectorAll("[name]").forEach((t=>s(t,"name"))),t.querySelectorAll("[id]").forEach((t=>s(t,"id"))),t.querySelectorAll("label[for]").forEach((t=>s(t,"for"))),this.counter++}replaceValue(t){const e=t.getAttribute("type");if("string"==typeof t.value&&e){if("text"!==e&&"number"!==e)return;t.value=""}t.querySelectorAll("input").forEach((t=>{const e=t.getAttribute("type");"text"!==e&&"number"!==e&&"email"!==e&&"tel"!==e||(t.value="")}))}createRemoveButton(){const t=createElement("button","add__button remove first-minus remove-field",'\n            <svg class="add__plus mr-10">\n               <use xlink:href="#minus-circle"></use>\n            </svg>\n            <span class="add__text">Удалить</span>\n        ');return t.setAttribute("type","button"),t}removeField(t){let e=this.addedFields.indexOf(t);e<0&&(e=this.addedFields.findIndex((e=>e.includes(t))));this.addedFields.filter(((t,s)=>s>e)).forEach((t=>{Array.isArray(t)?t.forEach((t=>this.replaceUniqueAttributes(t,!0))):this.replaceUniqueAttributes(t,!0)}));const s=this.addedFields[e];Array.isArray(s)?s.forEach((t=>t.remove())):s.remove(),this.addedFields.splice(e,1),this.counter--,this.addedFields.length<this.maxFieldsRepeat&&this.rootElem.classList.remove("none")}}class AddFieldByInput{constructor(t){this.onChange=this.onChange.bind(this),o=o.bind(this),n=n.bind(this),this.rootElem=t;const e=this.rootElem.dataset.addfieldInput,s=this.rootElem.getAttribute("name"),i=Array.from(document.querySelectorAll(`[data-addfield-input-target="${e}"]`));function n(){const t=document.querySelectorAll(`input[name="${s}"]`);this.onChange(),this.rootElem.addEventListener("change",this.onChange),t.forEach((t=>t.addEventListener("change",this.onChange)))}function o(t=!1){setTimeout((()=>{const e=inittedInputs.find((t=>!(!t.checkboxes||!t.rootElem.className.includes("selects-input-checkbox"))&&t.checkboxes.includes(this.rootElem)));if(!e)return t||setTimeout((()=>o(!0)),500),void(t&&n());e.applyButton?(e.rootElem.addEventListener("select-change",this.onChange),this.onChange()):o()}),0)}this.creatingElems=i.map((t=>({elem:t,anchor:createElement("div","none")}))),this.rootElem.closest(".selects-input-checkbox")?o():n()}onChange(){this.rootElem.checked?this.add():this.remove()}remove(){this.creatingElems.forEach((t=>{t.elem.replaceWith(t.anchor)}))}add(){this.creatingElems.forEach((t=>{t.anchor.replaceWith(t.elem)}))}}class MapBlock{constructor(t){this.lazyLoading=this.lazyLoading.bind(this),this.init=this.init.bind(this),this.getAddr=this.getAddr.bind(this),this.rootElem=t,this.selectsContainer=this.rootElem.querySelector(".map-block__selects"),this.mapContainer=this.rootElem.querySelector(".map-block__map"),this.selects=findInittedInput(".text-input",!0).filter((t=>t.rootElem.closest(".map-block__selects")===this.selectsContainer)),window.addEventListener("scroll",this.lazyLoading)}lazyLoading(){const t=window.pageYOffset,e=getCoords(this.mapContainer).top;Math.abs(t-e)<=2e3&&!this.isMapLoaded&&this.loadMap()}loadMap(){if(this.isMapLoaded)return;const t=createElement("script");t.setAttribute("id","maps-script"),t.src="https://api-maps.yandex.ru/2.1/?apikey=efe91807-ee6e-42c4-a379-25a218dcf1e7&lang=ru_RU",document.querySelector("#maps-script")?this.isMapLoaded=!0:(document.head.append(t),this.isMapLoaded=!0,window.removeEventListener("scroll",this.lazyLoading),t.onload=()=>{ymaps.ready(this.init)})}init(){this.map=new ymaps.Map("map",{center:[56.32687342,44.00291063],zoom:12}),this.initSearchInputs()}initSearchInputs(){this.regionSearch=this.rootElem.querySelector(".map-block__region"),this.streetSearch=this.rootElem.querySelector(".map-block__street"),this.houseSearch=this.rootElem.querySelector(".map-block__house"),this.regionSearch&&this.regionSearch.addEventListener("change",this.getAddr),this.streetSearch&&this.streetSearch.addEventListener("change",this.getAddr),this.houseSearch&&this.houseSearch.addEventListener("change",this.getAddr)}getAddr(){let t=this.regionSearch?this.regionSearch.value:"",e=this.streetSearch&&this.streetSearch.value?"ул. "+this.streetSearch.value:"",s=this.houseSearch&&this.houseSearch.value?"дом "+this.houseSearch.value:"";if(!t)return;t&&(e||s)&&(t+=", "),e&&s&&(e+=", ");let i=t+e+s;i&&ymaps.geocode(i,{results:1}).then((t=>{this.map.geoObjects.removeAll();const e=t.geoObjects.get(0),s=e.properties.get("boundedBy");this.map.geoObjects.add(e),this.map.setBounds(s,{checkZoomRange:!0})}))}}class ToggleOnchecked{constructor(t){this.onChange=this.onChange.bind(this),this.onMutation=this.onMutation.bind(this),s=s.bind(this),this.rootElem=t;const e=this.rootElem.dataset.toggleOnchecked.split(", ");if(this.data=assignPropertiesToObj(e),this.showBlock={value:s(this.data.inputShowValue),node:findClosest(this.rootElem,this.data.show),anchor:createElement("div","none")},this.hideBlock={value:s(this.data.inputHideValue),node:findClosest(this.rootElem,this.data.hide),anchor:createElement("div","none")},this.showBlock.node||(this.showBlock=null),this.hideBlock.node||(this.hideBlock=null),this.rootElem.removeAttribute("data-toggle-onchecked"),this.rootElem.addEventListener("change",this.onChange),"radio"===this.rootElem.type){const t=this.rootElem.getAttribute("name");document.querySelectorAll(`[name="${t}"]`).forEach((t=>t.addEventListener("change",this.onChange)))}function s(t){if(!t)return null;if(["#",".","["].includes(t[0])){const e=document.querySelector(t);return e||null}return t}new MutationObserver(this.onMutation).observe(document.body,{childList:!0,subtree:!0}),this.toggle()}onMutation(){this.rootElem.closest("body")?this.onChange():this.hide()}onChange(){this.checked=this.rootElem.checked,this.toggle()}toggle(){this.checked?this.show():this.hide()}show(){this.showBlock&&this.showBlock.anchor.closest("body")&&(this.showBlock.anchor.replaceWith(this.showBlock.node),this.showBlock.value&&this.setInputValue(this.showBlock)),this.hideBlock&&this.hideBlock.node.replaceWith(this.hideBlock.anchor)}hide(){this.hideBlock&&this.hideBlock.anchor.closest("body")&&(this.hideBlock.anchor.replaceWith(this.hideBlock.node),this.hideBlock.value&&this.setInputValue(this.hideBlock)),this.showBlock&&this.showBlock.node.replaceWith(this.showBlock.anchor)}setInputValue(t){const e=t.node.querySelector("input");if(!e)return;const s=t.value;e.value="string"==typeof s?t.value:t.value.value||"",e.dispatchEvent(new Event("input"))}}class CreatePopup{constructor(t){this.createPopup=this.createPopup.bind(this),this.initPopup=this.initPopup.bind(this),this.rootElem=t;const e=this.rootElem.dataset.createPopup;if(!e)throw new Error("Не указаны параметры data-create-popup");this.popupData=e.split(", "),this.popupName=this.popupData[0],this.popupParams=assignPropertiesToObj(this.popupData[1].split("; ")),this.popupParamsRoot=this.popupParams,this.popupParams.initOnLoad&&setTimeout((()=>{this.initPopup(!0),"close"===this.popupParams.initOnLoad&&this.popup.remove()}),0),this.rootElem.removeAttribute("data-create-popup");switch(this.rootElem.getAttribute("type")){case"checkbox":case"radio":this.initInputButton(),this.rootElem.parentNode.addEventListener("click",(()=>this.initPopup()));break;default:this.initClickableButton()}}initInputButton(){const t=this.rootElem.getAttribute("name"),e=document.querySelectorAll(`input[name="${t}"]`);this.otherInputs=[],e.forEach((t=>{if(t.addEventListener("change",(()=>{this.rootElem.checked&&this.initPopup()})),t===this.rootElem)return;t.addEventListener("change",(()=>this.onOtherInputChange(t)));let e=t.dataset.popupParams?t.dataset.popupParams.trim():"";e.endsWith(";")&&(e=e.slice(0,-1)),this.otherInputs.push({input:t,params:e}),t.removeAttribute("data-popup-params"),setTimeout((()=>{t.checked&&t.dispatchEvent(new Event("change"))}),250)}))}initClickableButton(){this.rootElem.addEventListener("click",(()=>this.initPopup()))}createPopup(){const t=this.popupParams.selectName;switch(this.popupName){case"standard":default:this.popup=new Popup;break;case"select-tags":const e=`\n                    <h3 class="popup__title">\n                        ${this.popupParams.title}\n                    </h3>\n                    <div class="selects-input-checkbox selects-input-checkbox--region" data-unset-max-height data-tags-select="${t}">\n                    <div class="selects-input-checkbox__wrapper">\n                        <input class="selects-input-checkbox__input" type="text" name="${t}">\n                        <span class="arrow"></span>\n                        <span class="cross">\n                            <svg>\n                                <use xlink:href="#cross-icon"></use>\n                            </svg>\n                        </span>\n                        <div class="prompt-hover__open">Очистить поле?</div>\n                        <div class="selects-wrap-checkbox" style="padding: 0px; margin: 0px;"></div>\n                    </div>\n                `;this.popup=new Popup({popupInner:e});let s=this.popupParams.defaultValues;s&&(s=s.split("|"),setTimeout((()=>{const t=inittedInputs.find((t=>{const e=this.popup.rootElem,s=t instanceof TextInputCheckboxes,i=t.rootElem.closest(".popup")===e;return s&&i}));t&&s.forEach((e=>t.setValue(e)))}),100));break;case"select-single-tag":const i=`\n                    <h3 class="popup__title">\n                        ${this.popupParams.title}\n                    </h3>\n                    <div class="text-input text-input--regions text-input-area" data-tags-select="${t}">\n                        <div class="text-input__wrapper">\n                            <input class="text-input__input" type="text">\n                            <div class="selects-wrap selects-wrap__max-width"></div>\n                        </div>\n                    </div>\n                `;this.popup=new Popup({popupInner:i})}}onOtherInputChange(t){const e=this.otherInputs.find((e=>e.input===t)).params;if(!e)return;e.split("; ").forEach((t=>{const e=t.split(":");this.popupParams[e[0]]=e[1]})),this.popup||this.initPopup(!0).then((()=>{this.popup.remove(),this.onOtherInputChange(t)}));const s=document.querySelector(`[data-tags-list="${this.popupParams.selectName}"]`)||[],i=()=>{t.checked&&(this.popupParams.removeCrossFromTags&&a.call(this),this.popupParams.removeAllTags&&o.call(this))};if(this.popupParams.setTags)return function(){const t=this.popupParams.setTags.split("|"),e=this.popup.inputsParams;if(!e)return;e.forEach((e=>{e instanceof TextInputCheckboxes&&t.forEach((t=>e.setValue(t)))}))}.call(this),void setTimeout((()=>i()),500);function n(){return Array.from(s.querySelectorAll(".tags-list__item")).map((t=>({tag:t,text:t.querySelector(".tags-list__item-text").innerText})))}function o(){const t=this.popupParams.removeAllTags.split("|");n().forEach((e=>{t.includes(e.text)||e.tag.querySelector(".tags-list__item-cross").dispatchEvent(new Event("click"))}))}function a(){o=o.bind(this);const e=this.popupParams.removeCrossFromTags.split("|"),s=n(),i=[];function o(){i.forEach((t=>{t.querySelector(".tags-list__item-cross").classList.remove("none"),this.rootElem.removeEventListener("change",o),this.otherInputs.forEach((t=>{t.input.removeEventListener("change",o)}))}))}e.forEach((t=>{const e=s.find((e=>e.text===t));if(!e)return;const n=e.tag;n.querySelector(".tags-list__item-cross").classList.add("none"),i.push(n)})),this.rootElem.addEventListener("change",o),this.otherInputs.forEach((e=>{e.input!==t&&e.input.addEventListener("change",o)}))}i()}initPopup(t=!1){return this.rootElem.checked&&(this.popupParams=this.popupParamsRoot),new Promise((e=>{this.popup||this.createPopup(),this.popup.init(t).then((t=>e(t)))}))}}class AddPhoto{constructor(t){this.onChange=this.onChange.bind(this),this.rootElem=t,this.input=this.rootElem.querySelector(".add-photo__input"),this.addPhotoWrapper=this.rootElem.querySelector(".add-photo__wrapper"),this.infoBlock=this.rootElem.querySelector(".add-photo__info"),this.button=this.rootElem.querySelector(".add-photo__button"),this.images=[],this.input.addEventListener("change",this.onChange)}onChange(){const t=this.input.files;for(let e=0;e<t.length;e++){const s=t[e];if(!s.type.startsWith("image/"))return;const i=calcSize(s.size);if(i.includes("мб")&&i>5)return;const n=new Image;n.onload=()=>{const t=createElement("div","add-photo__loaded-image"),s=createElement("div","add-photo__loaded-image-cross",'<svg><use xlink:href="#cross-icon"></use></svg>');s.addEventListener("click",(()=>this.removeImage(e))),t.append(n),t.append(s),this.images.push({img:n,fileIndex:e,imgWrapper:t}),this.appendImages()};const o=new FileReader;o.onload=t=>{n.src=t.target.result},o.readAsDataURL(s)}}appendImages(){this.toggleButton(),this.images.forEach((t=>{t.imgWrapper.closest("body")||this.addPhotoWrapper.append(t.imgWrapper)}))}toggleButton(){this.images.length>0?(this.infoBlock.classList.add("none"),this.button.classList.add("none")):(this.infoBlock.classList.remove("none"),this.button.classList.remove("none"))}removeImage(t){(function(){const e=this.images.find((e=>e.fileIndex==t));this.images=this.images.filter((t=>t!==e)),e.imgWrapper.remove()}).call(this),function(){const e=new DataTransfer,s=this.input.files;for(let i=0;i<s.length;i++){const n=s[i];i!==t&&e.items.add(n)}this.input.files=e.files}.call(this),this.toggleButton()}}class Form{constructor(t){this.onSubmit=this.onSubmit.bind(this),this.rootElem=t,this.rootElem.addEventListener("submit",this.onSubmit)}onSubmit(t){t.preventDefault();const e=findInittedInputByFlag("inputParams",!0).filter((t=>{if(!t.isRequired)return!1;return!t.checkCompletion()}));e.length>0&&e.forEach((t=>t.rootElem.classList.add("__uncompleted"))),console.log(e)}}let inputsInittingSelectors=[{selector:".text-input--standard",classInstance:TextInput,flag:"inputParams"},{selector:".text-input--regions",classInstance:TextInputRegions,flag:"inputParams"},{selector:".text-input--phone",classInstance:TextInputPhone,flag:"inputParams"},{selector:".text-input--date",classInstance:DateInput,flag:"inputParams"},{selector:".text-input--birthdate",classInstance:BirthdateInput,flag:"inputParams"},{selector:".time-schedule__select",classInstance:TimeScheduleInput,flag:"inputParams"},{selector:".time-schedule__item",classInstance:TimeScheduleItem,flag:"inputParams"},{selector:".textarea-wrapper",classInstance:Textarea,flag:"inputParams"},{selector:".tags-list",classInstance:TagsList,flag:"inputParams"},{selector:"[data-add-field]",classInstance:AddFieldButton,flag:"inputParams"},{selector:"[data-addfield-input]",classInstance:AddFieldByInput,flag:"inputParams"},{selector:".map-block",classInstance:MapBlock,flag:"inputParams"},{selector:"[data-toggle-onchecked]",classInstance:ToggleOnchecked,flag:"inputParams"},{selector:"[data-create-popup]",classInstance:CreatePopup,flag:"inputParams"},{selector:".selects-input-checkbox--standard",classInstance:TextInputCheckboxes,flag:"inputParams"},{selector:".selects-input-checkbox--region",classInstance:TextInputCheckboxesRegion,flag:"inputParams"},{selector:".radio-wrap",classInstance:RadioWrapper,flag:"inputParams"},{selector:".page-input-buttons",classInstance:PageInputButtons,flag:"inputParams"},{selector:".add-photo",classInstance:AddPhoto,flag:"inputParams"},{selector:"#form",classInstance:Form}];inittingSelectors=inittingSelectors.concat(inputsInittingSelectors);